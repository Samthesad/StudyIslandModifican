/* Copyright (c) 2017 WalkMe v2.12.5 */
;(function () { var __wmPrelibConfig = {"buildDate":"2021-04-18T07:03:34.389Z","plugins":[{"name":"wm-plugin-user-behavior@5.0.54@prelib","url":"prelib"}]};
!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){function r(){return y}var o=n(1),i=n(6),a=n(7),u=n(8).promiseManager,c=n(10).PluginsManager,s=n(11).EventsTrigger,f=n(11).EventsListener,l=n(14).LegoDI,p=n(15);window._walkmeInternals=window._walkmeInternals||{};var d=o["default"],h=new d({Promise:u.Promise,document:document});window._walkmeInternals.wmloader=h;var v=o.ActivationManager,g=new v({wmLoader:h});window._walkmeInternals.plugins=g;var y;i(window._walkmeInternals);var m=window._walkmeInternals.ctx;m.register("PromiseManager").asInstance(u),m.register("Promise").asCtor(u.Promise).asProto(),y=new l(window._walkmeInternals,c,u);var w=wmjQuery({}),_=new s(w,u),b=new f(w);window._walkmeInternals.events={listener:b,trigger:_,_eventsBase:w},y.ctx.register("EventsTrigger").asInstance(_),y.ctx.register("EventsListener").asInstance(b),y.ctx.register("PrelibLogger").asInstance(a);var E=function(){var t,e=window.wmSnippet||window.wmPlaySnippet||window.wmPreviewSnippet;return e&&(t=e.getSettingsFile()),t||(t={}),t}();u.resolve().then(function(){return p(__wmPrelibConfig,r,h)})["catch"](function(t){a.write("cannot load plugins"),a.write(t)}).then(function(){return a.write("starting plugins"),y.start(E)}).then(function(){a.write("plugins started")})["catch"](function(t){a.write("cannot start plugins"),a.write(t)})},function(t,e,n){"use strict";function r(t){function e(t,e,n){if(s.pluginsStateWrapper.shouldLoad(t)){var o=T[t]=T[t]||{name:t};if(o.factory||(o.factory=n,o.build=e),o.resolve)try{g(o,r(o))}catch(i){v(o,a(i,t))}}}function n(t,e){if(!t)throw new Error("cannot load module without a name");if(!e)throw new Error("cannot load module without an URL");if(!s.pluginsStateWrapper.shouldLoad(t))return A.push(t),_.resolve(function(e){(0,f.dummyPlugin)(e,t)});var n=T[t]=T[t]||{name:t};if(!n.promise)if(n.factory)n.promise=_.resolve(r(n));else{h(n);var o=l(t,e);"loaded"===o.status?v(n,u(t,e)):"error"===o.status&&v(n,c(t,e))}return n.promise}function r(t){return t.factory(t.build)}function l(t,e){var n=j[e];if(n)n.packages[t]=!0;else{var r;n=j[e]={url:e,status:"loading",start:new Date,packages:(r={},r[t]=!0,r)};var o=d(e);p(o,e),k.appendChild(o)}return n}function p(t,e){if(t.addEventListener)t.addEventListener("load",M(e),!1),t.addEventListener("error",P(e),!1);else{if(!t.attachEvent)throw new Error("neither addEventListener nor attachEvent is supported");t.attachEvent("onreadystatechange",M(e))}}function d(t){var e=b.createElement("script");return e.type="text/javascript",e.charset="utf-8",e.async=!0,e.src=t,e}function h(t){t.promise=new _(function(e,n){t.resolve=e,t.reject=n})}function v(t,e){w(e),t.reject(e),y(t)}function g(t,e){t.resolve(e),y(t)}function y(t){delete t.resolve,delete t.reject}function m(t){t.parentNode.removeChild(t)}function w(t){t.date=new Date,x.push(t)}var _=t.Promise,b=t.document,E=this;E.load=n,E.define=e;var k=b.getElementsByTagName("head")[0],j={},T={},x=[],A=[];E.bundles=j,E.packages=T,E.errors=x,E.inactive=A;var M=function(t){return function(e){if(o(e)){var n=j[t];n.status="loaded",n.loadMs||(n.loadMs=(new Date).getTime()-n.start);for(var r in n.packages)if(n.packages.hasOwnProperty(r)){var a=T[r];a.reject&&v(a,u(r,t))}m(i(e))}}},P=function(t){return function(e){var n=j[t];n.status="error",n.loadMs||(n.loadMs=(new Date).getTime()-n.start);for(var r in n.packages)if(n.packages.hasOwnProperty(r)){var o=T[r];o.reject&&v(o,c(r,t))}m(i(e))}}}function o(t){if("load"===t.type)return!0;var e=i(t),n=e.readyState;return"complete"===n||"loaded"===n}function i(t){return t.currentTarget||t.srcElement}function a(t,e){var n=new Error("error thrown in factory. package: "+e+"\ncaused by:\n"+t.stack);return n.name="FactoryError",n.cause=t,n["package"]=e,n}function u(t,e){var n=new Error("package not found in the specified bundle. package: "+t+", bundle: "+e);return n.name="PackageNotFound",n["package"]=t,n.bundle=e,n}function c(t,e){var n=new Error("cannot load bundle. package: "+t+", bundle: "+e);return n.name="BundleLoadError",n["package"]=t,n.bundle=e,n}e.__esModule=!0,e["default"]=r;var s=n(2),f=n(4),l=n(5);e.ActivationManager=l.ActivationManager},function(t,e,n){"use strict";function r(){function t(t){return!(0===i[t])}function e(t){o.cookieManager.setCookie(a,JSON.stringify(t),86400)}function n(){return JSON.parse(o.cookieManager.getCookie(a)||"{}")}var r=this;r.shouldLoad=t,r.saveState=e,r.getState=n;var i=void 0,a="walkme_prelib_activ_state";!function(){i=JSON.parse(o.cookieManager.getCookie(a)||"{}")}()}e.__esModule=!0,e.pluginsStateWrapper=undefined;var o=n(3);e.pluginsStateWrapper=new r},function(t,e){"use strict";function n(){function t(){return"https:"===window.location.protocol}function e(t,e,n,r){"string"!=typeof e&&(e=e.toString()),e=encodeURIComponent(e);var a="";r&&r.length>0&&(a="; domain="+r);var u=new Date;u.setTime(u.getTime()+1e3*n);var c="; expires="+u.toUTCString(),s=i?o:"",f=e+c+"; path=/"+a;document.cookie=t+"="+f+s}function n(t){for(var e=document.cookie.split(";"),n=0;n<e.length;n++){var r=e[n].substr(0,e[n].indexOf("=")),o=e[n].substr(e[n].indexOf("=")+1);if((r=r.replace(/^\s+|\s+$/g,""))===t)return decodeURIComponent(o)}}var r=this;r.setCookie=e,r.getCookie=n;var o=";secure",i=void 0;!function(){i=t()}()}e.__esModule=!0;e.cookieManager=new n},function(t,e){"use strict";function n(t,e){t().ctx.get("PrelibLogger").write("[wm-loader] "+e+" is disabled and therefore not loaded")}e.__esModule=!0,e.dummyPlugin=n},function(t,e,n){"use strict";function r(t){function e(){var t=[];for(var e in s.packages)s.packages.hasOwnProperty(e)&&t.push({name:e,isActive:!0});for(var n=0;n<s.inactive.length;n++)t.push({name:s.inactive[n],isActive:!1});return t}function n(t){u(t,l.inactive)}function r(t){u(t,l.active)}function i(){c(l.active)}function a(){c(l.inactive)}function u(t,e){var n=o.pluginsStateWrapper.getState();n[t]=e,o.pluginsStateWrapper.saveState(n)}function c(t){var e={};for(var n in s.packages)s.packages.hasOwnProperty(n)&&(e[n]=t);for(var r=0;r<s.inactive.length;r++)e[s.inactive[r]]=t;o.pluginsStateWrapper.saveState(e)}var s=t.wmLoader,f=this;f.list=e,f.deactivateAll=a,f.activateAll=i,f.activate=r,f.deactivate=n;var l={active:1,inactive:0}}e.__esModule=!0,e.ActivationManager=r;var o=n(2)},function(t,e){!function(){function e(t,e){this._object=undefined,this._name=t,this._ctx=e,this.properties={strategy:i.defaults.strategy,factory:i.defaults.factory,injector:i.defaults.injector,load:i.defaults.load,wasReady:!1,initialize:!0}}e.prototype.name=function(){return this._name},e.prototype.asFactory=function(t,e){return e!=undefined&&this.type(e),this.factory(t),this},e.prototype.loadDependencies=function(t,e){return e!=undefined&&this.dependencies(e),this.load(t),this},e.prototype.asFunction=function(t){return this.asFactory(i.factory.func,t)},e.prototype.asInstance=function(t){return this.asFactory(i.factory.instance,t)},e.prototype.asCtor=function(t){return this.asFactory(i.factory.constructor,t)},e.prototype.asSingleton=function(){return this.strategy(i.strategy.singleton)},e.prototype.asProto=function(){return this.strategy(i.strategy.proto)},e.prototype.injectToCtor=function(){return this.injector(i.injector.ctor)},e.prototype.injectToReady=function(){return this.injector(i.injector.ready)},e.prototype.injectToProperty=function(){return this.injector(i.injector.property)},e.prototype.flatDependencies=function(t){return this.loadDependencies(i.load.flat,t)},e.prototype.recursiveDependencies=function(t){return this.loadDependencies(i.load.recursive,t)},e.prototype.useOnce=function(){var t=this.getObject;return this.getObject=function(){return this._ctx.map[this.name()]=null,t.apply(this,arguments)},this},e.prototype.depsDictionary=function(t){return arguments.length?(this.properties.depsDictionary=t,this):(this.properties.depsDictionary||this.depsDictionary(this._ctx.resolve(this)),this.properties.depsDictionary)},e.prototype.create=function(t,e,n){n=n||i.load.recursive;var r=this.properties.strategy.test(this._object,n);if(e)return r;r&&(t=this.properties.injector.create(t||this.properties.args,this,this._ctx,n));var o=this.properties.strategy.create(this._object,this.properties.factory,this.properties.type,t,this._ctx,this,n);return this._ctx.ready(o,this)},e.prototype.getObject=function(t){return this.create(undefined,undefined,t)},e.prototype.object=function(t){return arguments.length?(this._object=t,this):this.create()};for(var n=["load","wasReady","strategy","injector","type","dependencies","args","factory","initialize"],r=0;r<n.length;r++){var o=n[r];!function(t){e.prototype[t]=function(e){return arguments.length?(this.properties[t]=e,this):this.properties[t]}}(o)}/**
	 * @license
	 *  Copyright 2013 the original author or authors.
	 *  Licensed under the Apache License, Version 2.0 (the "License");
	 *  You may obtain a copy of the License at
	 *
	 *		http://www.apache.org/licenses/LICENSE-2.0
	    *
	    *  Unless required by applicable law or agreed to in writing, software
	    *  distributed under the License is distributed on an "AS IS" BASIS,
	    *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
	    *  See the License for the specific language governing permissions and
	    *  limitations under the License.
	    */
var i=function(t){function n(t,e,n,r,o){var i=t(e,n,o),a=r.decorators[o.name()];if(a)for(var u=0;u<a.length;u++)i=a[u](i);return i}t=t||{},t.version="0.3.3";return t.logger=function(t,e){},t.log=function(e,n,r){n&&(e="[class="+n.name()+"] "+e),t.logger("DI - "+e,r||4)},t.error=function(e,n,r){t.log(e,n,r)},t.createContext=function(){function e(t){for(;t.indexOf(" ")>=0;)t=t.replace(" ","");return t}var n={map:{},decorators:{}};return n.decorate=function(t,e){n.decorators[t]||(n.decorators[t]=[]),n.decorators[t].push(e)},n.entry=function(t){return n.map[t]},n.register=function(e,r,o){var i=t.entry(e,n).type(r).args(o);return n.map[e]=i,i},n.has=function(t){return null!=n.entry(t)},n.remove=function(t){return!!n.has(t)&&(n.map[t]=null,!0)},n.isEntryRemoved=function(t){return null===n.entry(t)},n.get=function(e,r){return n.isEntryRemoved(e)&&t.error("Object["+e+"] was removed"),n.has(e)||t.error("Object["+e+"] is not registered"),n.entry(e).getObject(r)},n.create=function(e,r){if(n.entry(e).strategy()==t.strategy.singleton&&t.error("Attempt to create singleton object ["+e+"]"),n.has(e))return n.entry(e).create(r);t.error("Object["+e+"] is not registered")},n.initialize=function(){function e(e){var r=n.entry(e);r?r.initialize()&&r.strategy().initialize()&&n.get(e):t.error("Object["+e+"] is not registered")}return function(t){if(t)e(t);else for(var t in n.map)e(t)}}(),n.clear=function(){this.map={},this.decorators={}},n.resolve=function(e){var r=e.load(),o={};return n.eachDependency(e.dependencies(),function(i,a){var u=n.get(i,r);n.ready(u,n.entry(i)),null==u&&t.error("Dependency ["+e.name()+"."+a+"]->["+i+"] can not be satisfied",e),o[a]=u}),o},n.eachDependency=function(n,r){if(n)for(var o=e(n).split(","),i=0;i<o.length;i++){var a=o[i];if(a){var u=t.dependencyExpression(a);try{r(u.name,u.property,i)}catch(c){t.error("An exception was thrown while the DI tried to resolve class '"+u.name+"'. Check the class name, or if it was registred correctly. \r\n inner exception: \r\n"+c.message)}}}},n.ready=function(t,e){if(null===e&&t)return t;var r=e.wasReady();if(e.wasReady(!0),!r){var o=n.createCallback();o&&o(e.name(),t),t&&"function"==typeof t.ready&&t!=window&&t!=window.document&&t!=window.document.body&&(e.wasReady(!0),t.ready.apply(t,e.injector().ready(t,e)||[]))}return t},n.createCallback=function(){var t;return function(e){return 0==arguments.length?t:(t=e,n)}}(),n},t.dependencyExpression=function(t){var e={},n=t,r=t;if(t.indexOf("=")>0){var o=t.split("=");n=o[0],r=o[1]}return e.name=r,e.property=n,e},t.entry=function(t,n){return new e(t,n)},t.strategy={proto:{test:function(t,e){return!e||e()},initialize:function(){return!1},create:function(t,e,r,o,i,a,u){return t=n(e,r,o,i,a),u()&&a.injector().ready(t,a),a.depsDictionary(undefined),a.wasReady(!1),t}},singleton:{test:function(t,e){return!t&&(!e||e())},initialize:function(){return!0},create:function(t,e,r,o,i,a,u){return t||(t=n(e,r,o,i,a),a.object(t),a.wasReady(!0),u()&&a.injector().ready(t,a),a.wasReady(!1)),t}}},t.factory={constructor:function(e,n,r){return n instanceof Array?n.length<=10?new e(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9]):n.length<=30?new e(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15],n[16],n[17],n[18],n[19],n[20],n[21],n[22],n[23],n[24],n[25],n[26],n[27],n[28],n[29]):void t.error("trying to create a class with too many args!",r):new e(n)},func:function(t,e,n){return e instanceof Array?t.apply(t,e):t(e)},instance:function(t,e,n){return t}},t.injector={property:{create:function(t,e,n){return t},ready:function(t,e){var n=e.depsDictionary();for(var r in n)t[r]=n[r];var o=e.args();o==undefined||n.hasOwnProperty("args")||(t.args=o)}},ready:{create:function(t,e,n){return t},ready:function(t,e){var n=e.args(),r=[],o=e.depsDictionary();if(a.eachDependency(e.dependencies(),function(t,e,n){r[n]=o[e]}),n){n=n instanceof Array?n:[n];for(var i=0;i<n.length;i++)r.push(n[i])}return r}},ctor:{create:function(t,e,n){var r=[],o=e.depsDictionary();if(n.eachDependency(e.dependencies(),function(t,e,n){r[n]=o[e]}),t){t=t instanceof Array?t:[t];for(var i=0;i<t.length;i++)r.push(t[i])}return r},ready:function(t,e){}}},t.load={flat:function(t,e,n){return!1},recursive:function(t,e,n){return!0}},t.defaults={strategy:t.strategy.singleton,factory:t.factory.constructor,injector:t.injector.ctor,load:t.load.recursive},t}(),a=i.createContext();t.exports=function(t){t.di=i,t.ctx=a}}()},function(t,e){"use strict";function n(){if(s()){var t=arguments;try{t.stack=(new Error).stack}catch(n){}r(t);var e=Array().slice.call(t);console.log.apply(console,e)}}function r(t){var e=new Date;t.timeElapsed=e-(h||e),h=e,y.unshift(t),y=y.splice(0,g)}function o(){return y}function i(t){v=t}function a(){return v}function u(){d=!0,p(v,!0)}function c(){d=!1,p(v,"",-1)}function s(){return void 0!==d?d:(f(),d)}function f(){var t=window.console&&(l(v)||!1);d=t&&"true"==t.toString().toLowerCase()}function l(t){var e=document.cookie.match("(^|;)\\s*"+t+"\\s*=\\s*([^;]+)");return e?e.pop():undefined}function p(t,e,n){var r,o="";n&&(r=new Date,r.setTime(r.getTime()+864e5*n),o="; expires="+r.toUTCString()),document.cookie=t+"="+e+o+"; path=/"}var d,h,v="walkme_prelib_log_enabled",g=1e4,y=[],m={write:n,getCookieName:a,setCookieName:i,enableLog:u,disableLog:c,isLogEnabled:s,readCookie:l,writeCookie:p,getLogHistoryRecords:o};t.exports=m},function(t,e,n){(function(t,r){/*!
	 * @overview RSVP - a tiny implementation of Promises/A+.
	 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors
	 * @license   Licensed under MIT license
	 *            See https://raw.githubusercontent.com/tildeio/rsvp.js/master/LICENSE
	 * @version   3.1.0
	 */
e.promiseManager=function(){"use strict";function e(t){return"function"==typeof t||"object"==typeof t&&null!==t}function o(t){return"function"==typeof t}function i(t){return"object"==typeof t&&null!==t}function a(){}function u(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}function c(t){var e=t._promiseCallbacks;return e||(e=t._promiseCallbacks={}),e}function s(t,e){return"onerror"===t?void _t.on("error",e):2!==arguments.length?_t[t]:void(_t[t]=e)}function f(){setTimeout(function(){for(var t,e=0;e<bt.length;e++){t=bt[e];var n=t.payload;n.guid=n.key+n.id,n.childGuid=n.key+n.childId,n.error&&(n.stack=n.error.stack),_t.trigger(t.name,t.payload)}bt.length=0},50)}function l(t,e,n){1===bt.push({name:t,payload:{key:e._guidKey,id:e._id,eventName:t,detail:e._result,childId:n&&n._id,label:e._label,timeStamp:yt(),error:_t["instrument-with-stack"]?new Error(e._label):null}})&&f()}function p(){return new TypeError("A promises callback cannot return that same promise.")}function d(){}function h(t){try{return t.then}catch(e){return xt.error=e,xt}}function v(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function g(t,e,n){_t.async(function(t){var r=!1,o=v(n,e,function(n){r||(r=!0,e!==n?w(t,n):b(t,n))},function(e){r||(r=!0,E(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,E(t,o))},t)}function y(t,e){e._state===jt?b(t,e._result):e._state===Tt?(e._onError=null,E(t,e._result)):k(e,undefined,function(n){e!==n?w(t,n):b(t,n)},function(e){E(t,e)})}function m(t,e){if(e.constructor===t.constructor)y(t,e);else{var n=h(e);n===xt?E(t,xt.error):n===undefined?b(t,e):o(n)?g(t,e,n):b(t,e)}}function w(t,n){t===n?b(t,n):e(n)?m(t,n):b(t,n)}function _(t){t._onError&&t._onError(t._result),j(t)}function b(t,e){t._state===kt&&(t._result=e,t._state=jt,0===t._subscribers.length?_t.instrument&&Et("fulfilled",t):_t.async(j,t))}function E(t,e){t._state===kt&&(t._state=Tt,t._result=e,_t.async(_,t))}function k(t,e,n,r){var o=t._subscribers,i=o.length;t._onError=null,o[i]=e,o[i+jt]=n,o[i+Tt]=r,0===i&&t._state&&_t.async(j,t)}function j(t){var e=t._subscribers,n=t._state;if(_t.instrument&&Et(n===jt?"fulfilled":"rejected",t),0!==e.length){for(var r,o,i=t._result,a=0;a<e.length;a+=3)r=e[a],o=e[a+n],r?A(n,r,o,i):o(i);t._subscribers.length=0}}function T(){this.error=null}function x(t,e){try{return t(e)}catch(n){return At.error=n,At}}function A(t,e,n,r){var i,a,u,c,s=o(n);if(s){if(i=x(n,r),i===At?(c=!0,a=i.error,i=null):u=!0,e===i)return void E(e,p())}else i=r,u=!0;e._state!==kt||(s&&u?w(e,i):c?E(e,a):t===jt?b(e,i):t===Tt&&E(e,i))}function M(t,e){var n=!1;try{e(function(e){n||(n=!0,w(t,e))},function(e){n||(n=!0,E(t,e))})}catch(r){E(t,r)}}function P(t,e,n){return t===jt?{state:"fulfilled",value:n}:{state:"rejected",reason:n}}function C(t,e,n,r){var o=this;o._instanceConstructor=t,o.promise=new t(d,r),o._abortOnReject=n,o._validateInput(e)?(o._input=e,o.length=e.length,o._remaining=e.length,o._init(),0===o.length?b(o.promise,o._result):(o.length=o.length||0,o._enumerate(),0===o._remaining&&b(o.promise,o._result))):E(o.promise,o._validationError())}function S(t,e){return new Mt(this,t,!0,e).promise}function O(t,e){function n(t){w(i,t)}function r(t){E(i,t)}var o=this,i=new o(d,e);if(!gt(t))return E(i,new TypeError("You must pass an array to race.")),i;for(var a=t.length,u=0;i._state===kt&&u<a;u++)k(o.resolve(t[u]),undefined,n,r);return i}function L(t,e){var n=this;if(t&&"object"==typeof t&&t.constructor===n)return t;var r=new n(d,e);return w(r,t),r}function D(t,e){var n=this,r=new n(d,e);return E(r,t),r}function I(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function R(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function N(t,e){var n=this;n._id=Dt++,n._label=e,n._state=undefined,n._result=undefined,n._subscribers=[],_t.instrument&&Et("created",n),d!==t&&(o(t)||I(),n instanceof N||R(),M(n,t))}function W(t,e,n){this._superConstructor(t,e,!1,n)}function B(t,e){return new W(It,t,e).promise}function F(t,e){return It.all(t,e)}function U(t,e){$t[Ft]=t,$t[Ft+1]=e,2===(Ft+=2)&&Nt()}function z(){return function(){Rt(H)}}function Y(){return function(){setTimeout(H,1)}}function H(){for(var t=0;t<Ft;t+=2){(0,$t[t])($t[t+1]),$t[t]=undefined,$t[t+1]=undefined}Ft=0}function J(t){var e={};return e.promise=new It(function(t,n){e.resolve=t,e.reject=n},t),e}function K(t,e,n){return It.all(t,n).then(function(t){if(!o(e))throw new TypeError("You must pass a function as filter's second argument.");for(var r=t.length,i=new Array(r),a=0;a<r;a++)i[a]=e(t[a]);return It.all(i,n).then(function(e){for(var n=new Array(r),o=0,i=0;i<r;i++)e[i]&&(n[o]=t[i],o++);return n.length=o,n})})}function $(t,e,n){this._superConstructor(t,e,!0,n)}function G(t,e,n){this._superConstructor(t,e,!1,n)}function Q(t,e){return new G(It,t,e).promise}function q(t,e){return new qt(It,t,e).promise}function V(t,e,n){return It.all(t,n).then(function(t){if(!o(e))throw new TypeError("You must pass a function as map's second argument.");for(var r=t.length,i=new Array(r),a=0;a<r;a++)i[a]=e(t[a]);return It.all(i,n)})}function X(){this.value=undefined}function Z(t){try{return t.then}catch(e){return te.value=e,te}}function tt(t,e,n){try{t.apply(e,n)}catch(r){return te.value=r,te}}function et(t,e){for(var n,r,o={},i=t.length,a=new Array(i),u=0;u<i;u++)a[u]=t[u];for(r=0;r<e.length;r++)n=e[r],o[n]=a[r+1];return o}function nt(t){for(var e=t.length,n=new Array(e-1),r=1;r<e;r++)n[r-1]=t[r];return n}function rt(t,e){return{then:function(n,r){return t.call(e,n,r)}}}function ot(t,e){var n=function(){for(var n,r=this,o=arguments.length,i=new Array(o+1),a=!1,u=0;u<o;++u){if(n=arguments[u],!a){if((a=ut(n))===ee){var c=new It(d);return E(c,ee.value),c}a&&!0!==a&&(n=rt(a,n))}i[u]=n}var s=new It(d);return i[o]=function(t,n){t?E(s,t):e===undefined?w(s,n):!0===e?w(s,nt(arguments)):gt(e)?w(s,et(arguments,e)):w(s,n)},a?at(s,i,t,r):it(s,i,t,r)};return n.__proto__=t,n}function it(t,e,n,r){var o=tt(n,r,e);return o===te&&E(t,o.value),t}function at(t,e,n,r){return It.all(e).then(function(e){var o=tt(n,r,e);return o===te&&E(t,o.value),t})}function ut(t){return!(!t||"object"!=typeof t)&&(t.constructor===It||Z(t))}function ct(t,e){return It.race(t,e)}function st(t,e){return It.reject(t,e)}function ft(t,e){return It.resolve(t,e)}function lt(t){throw setTimeout(function(){throw t}),t}function pt(t,e){_t.async(t,e)}function dt(){_t.on.apply(_t,arguments)}function ht(){_t.off.apply(_t,arguments)}var vt;vt=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var gt=vt,yt=Date.now||function(){return(new Date).getTime()},mt=Object.create||function(t){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof t)throw new TypeError("Argument must be an object");return a.prototype=t,new a},wt={mixin:function(t){return t.on=this.on,t.off=this.off,t.trigger=this.trigger,t._promiseCallbacks=undefined,t},on:function(t,e){if("function"!=typeof e)throw new TypeError("Callback must be a function");var n,r=c(this);n=r[t],n||(n=r[t]=[]),-1===u(n,e)&&n.push(e)},off:function(t,e){var n,r,o=c(this);if(!e)return void(o[t]=[]);n=o[t],-1!==(r=u(n,e))&&n.splice(r,1)},trigger:function(t,e,n){var r,o=c(this);if(r=o[t])for(var i=0;i<r.length;i++)(0,r[i])(e,n)}},_t={instrument:!1};wt.mixin(_t);var bt=[],Et=l,kt=void 0,jt=1,Tt=2,xt=new T,At=new T,Mt=C;C.prototype._validateInput=function(t){return gt(t)},C.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},C.prototype._init=function(){this._result=new Array(this.length)},C.prototype._enumerate=function(){for(var t=this,e=t.length,n=t.promise,r=t._input,o=0;n._state===kt&&o<e;o++)t._eachEntry(r[o],o)},C.prototype._eachEntry=function(t,e){var n=this,r=n._instanceConstructor;i(t)?t.constructor===r&&t._state!==kt?(t._onError=null,n._settledAt(t._state,e,t._result)):n._willSettleAt(r.resolve(t),e):(n._remaining--,n._result[e]=n._makeResult(jt,e,t))},C.prototype._settledAt=function(t,e,n){var r=this,o=r.promise;o._state===kt&&(r._remaining--,r._abortOnReject&&t===Tt?E(o,n):r._result[e]=r._makeResult(t,e,n)),0===r._remaining&&b(o,r._result)},C.prototype._makeResult=function(t,e,n){return n},C.prototype._willSettleAt=function(t,e){var n=this;k(t,undefined,function(t){n._settledAt(jt,e,t)},function(t){n._settledAt(Tt,e,t)})};var Pt=S,Ct=O,St=L,Ot=D,Lt="rsvp_"+yt()+"-",Dt=0,It=N;N.cast=St,N.all=Pt,N.race=Ct,N.resolve=St,N.reject=Ot,N.prototype={constructor:N,_guidKey:Lt,_onError:function(t){var e=this;_t.after(function(){e._onError&&_t.trigger("error",t,e._label)})},then:function(t,e,n){var r=this,o=r._state;if(o===jt&&!t||o===Tt&&!e)return _t.instrument&&Et("chained",r,r),r;r._onError=null;var i=new r.constructor(d,n),a=r._result;if(_t.instrument&&Et("chained",r,i),o){var u=arguments[o-1];_t.async(function(){A(o,i,u,a)})}else k(r,i,t,e);return i},"catch":function(t,e){return this.then(undefined,t,e)},"finally":function(t,e){var n=this,r=n.constructor;return n.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){throw e})},e)}},W.prototype=mt(Mt.prototype),W.prototype._superConstructor=Mt,W.prototype._makeResult=P,W.prototype._validationError=function(){return new Error("allSettled must be called with an array")};var Rt,Nt,Wt=B,Bt=F,Ft=0,Ut=U,zt="undefined"!=typeof window?window:undefined,Yt=zt||{},Ht=Yt.MutationObserver||Yt.WebKitMutationObserver,Jt="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),Kt="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,$t=new Array(1e3);Nt=Jt?function(){var e=t.nextTick,n=t.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(n)&&"0"===n[1]&&"10"===n[2]&&(e=setImmediate),function(){e(H)}}():Ht?function(){var t=0,e=new Ht(H),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}():Kt?function(){var t=new MessageChannel;return t.port1.onmessage=H,function(){t.port2.postMessage(0)}}():zt===undefined?function(){try{var t=n(!function(){var t=new Error('Cannot find module "vertx"');throw t.code="MODULE_NOT_FOUND",t}());return Rt=t.runOnLoop||t.runOnContext,z()}catch(e){return Y()}}():Y();var Gt=J,Qt=K,qt=$;$.prototype=mt(Mt.prototype),$.prototype._superConstructor=Mt,$.prototype._init=function(){this._result={}},$.prototype._validateInput=function(t){return t&&"object"==typeof t},$.prototype._validationError=function(){return new Error("Promise.hash must be called with an object")},$.prototype._enumerate=function(){var t=this,e=t.promise,n=t._input,r=[];for(var o in n)e._state===kt&&Object.prototype.hasOwnProperty.call(n,o)&&r.push({position:o,entry:n[o]});var i=r.length;t._remaining=i;for(var a,u=0;e._state===kt&&u<i;u++)a=r[u],t._eachEntry(a.entry,a.position)},G.prototype=mt(qt.prototype),G.prototype._superConstructor=Mt,G.prototype._makeResult=P,G.prototype._validationError=function(){return new Error("hashSettled must be called with an object")};var Vt=Q,Xt=q,Zt=V,te=new X,ee=new X,ne=ot;if("object"==typeof self)self;else{if("object"!=typeof r)throw new Error("no global: `self` or `global` found");r}var re=ct,oe=st,ie=ft,ae=lt;_t.async=Ut,_t.after=function(t){setTimeout(t,0)};if("undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var ue=window.__PROMISE_INSTRUMENTATION__;s("instrument",!0);for(var ce in ue)ue.hasOwnProperty(ce)&&dt(ce,ue[ce])}return{race:re,Promise:It,allSettled:Wt,hash:Xt,hashSettled:Vt,denodeify:ne,on:dt,off:ht,map:Zt,filter:Qt,resolve:ie,reject:oe,all:Bt,rethrow:ae,defer:Gt,EventTarget:wt,configure:s,async:pt}}()}).call(e,n(9),function(){return this}())},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(f===setTimeout)return setTimeout(t,0);if((f===n||!f)&&setTimeout)return f=setTimeout,setTimeout(t,0);try{return f(t,0)}catch(e){try{return f.call(null,t,0)}catch(e){return f.call(this,t,0)}}}function i(t){if(l===clearTimeout)return clearTimeout(t);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(e){try{return l.call(null,t)}catch(e){return l.call(this,t)}}}function a(){v&&d&&(v=!1,d.length?h=d.concat(h):g=-1,h.length&&u())}function u(){if(!v){var t=o(a);v=!0;for(var e=h.length;e;){for(d=h,h=[];++g<e;)d&&d[g].run();g=-1,e=h.length}d=null,v=!1,i(t)}}function c(t,e){this.fun=t,this.array=e}function s(){}var f,l,p=t.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:n}catch(t){f=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(t){l=r}}();var d,h=[],v=!1,g=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new c(t,e)),1!==h.length||v||o(u)},c.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=s,p.addListener=s,p.once=s,p.off=s,p.removeListener=s,p.removeAllListeners=s,p.emit=s,p.prependListener=s,p.prependOnceListener=s,p.listeners=function(t){return[]},p.binding=function(t){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(t){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(t,e){"use strict";var n=function(){function t(t){this.promiseManager=t,this._plugins=[]}return t.prototype.register=function(t){this._plugins.push(t)},t.prototype.run=function(t){for(var e,n=this._plugins,r=[],o=0;o<n.length;o++)(e=n[o].run(t))&&r.push(e);return this.promiseManager.all(r)},t}();e.PluginsManager=n},function(t,e,n){"use strict";e.__esModule=!0;var r=n(12);e.EventsListener=r.EventsListener;var o=n(13);e.EventsTrigger=o.EventsTrigger},function(t,e){"use strict";function n(t){return t.__wmEventWrapped||(t.__wmEventWrapped=r(t)),t.__wmEventWrapped}function r(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=t.apply(this,e),o=(e[0],e[1]);return o&&o.__asyncResults&&o.__asyncResults.push(r),r}}function o(t){return t&&t.__wmEventWrapped||t}e.__esModule=!0;var i=function(){function t(t){this._eventsBase=t}return t.prototype.on=function(t,e){var r=n(e);this._eventsBase.on(t,r)},t.prototype.once=function(t,e){var r=n(e);this._eventsBase.one(t,r)},t.prototype.off=function(t,e){var n=o(e);this._eventsBase.off(t,n)},t}();e.EventsListener=i},function(t,e){"use strict";e.__esModule=!0;var n=function(){function t(t,e){this._eventsBase=t,this._promiseManager=e}return t.prototype.async=function(t,e,n,r){var o;try{o=this._eventsBase.triggerHandler(t,e)}catch(i){r&&r()}this._promiseManager.Promise.resolve(o).then(n,r)},t.prototype.sync=function(t,e,n){var r=e&&e.asyncCallback;r&&(e.__asyncResults=[]);var o=this._eventsBase.triggerHandler(t,e);return r&&(o=this._promiseManager.all(e.__asyncResults).then(function(t){return t[t.length-1]})),o==undefined?n:o},t}();e.EventsTrigger=n},function(t,e){"use strict";var n=function(){function t(t,e,n){this.PluginsManager=e,this._configs=new this.PluginsManager(n),this._plugins=new this.PluginsManager(n),this.ctx=t.ctx,this.di=t.di}return t.prototype.config=function(t){this._configs.register(t)},t.prototype.plugin=function(t){this._plugins.register(t)},t.prototype.start=function(t){var e=this,n=this._configs,r=this._plugins;return n.run(t).then(function(){return r.run(t)}).then(function(){return e.callWalkmePreLibLoaded()})["catch"](function(t){e.logError(t)})},t.prototype.callWalkmePreLibLoaded=function(){window.walkme_pre_lib_loaded&&window.walkme_pre_lib_loaded()},t.prototype.logError=function(t){throw this.ctx.has("PrelibLogger")&&this.ctx.get("PrelibLogger").write("Prelib encountered an error while loading: "+t+"\nDetails:\n"+t.stack),t},t}();e.LegoDI=n},function(t,e){function n(t,e,n){function r(){for(var t=["[prelib-loader]"],e=0;e<arguments.length;e++)t.push(arguments[e]);c.write.apply(c,t)}function o(){return undefined}var i=e(),a=i.ctx,u=a.get("PromiseManager").Promise,c=a.get("PrelibLogger");r("loading plugins",t);for(var s=[],f=0;f<t.plugins.length;f++){var l=function(t){return r("loading",t.name,"from",t.url),n.load(t.name,t.url).then(function(n){r("loaded",t.name),n(e)})["catch"](function(e){r("cannot load",t.name),c.write(e),n.errors.push(e)})}(t.plugins[f]);s.push(l)}return u.all(s).then(o)}t.exports=n}]);
})();

﻿"undefined"!=typeof _walkmeInternals&&_walkmeInternals.wmloader&&_walkmeInternals.wmloader.define("wm-plugin-user-behavior@5.0.54@prelib",{name:"wm-plugin-user-behavior",version:"5.0.54",toolbelt:"1.2.9",packageDate:"2021-04-12T19:46:19.208Z",entry:"prelib"},function(e){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}return r.m=e,r.c=t,r.p="",r(0)}([function(e,t,r){e.exports=r(1)},function(e,t,r){var n=r(2).createPluginEntry;e.exports=n(function(e){var t=r(3).WmPluginAbra;e(new t)})},function(e,t){var r,n={createPluginEntry:i,getCtx:o};function i(e){return function(t){r=t(),e(a)}}function o(){return r.ctx}function a(e){r.plugin(e)}t.__esModule=!0,t["default"]=n,t.createPluginEntry=n.createPluginEntry,t.getCtx=n.getCtx},function(e,t,r){var n=r(2).getCtx;function i(){this.run=e;function e(){return r(4).start(n())}}t.WmPluginAbra=i},function(e,t,r){var n=function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},i=function(){function e(){}return e.registerClass=function(t,r,n){e.classRegistrations.push({name:t,ctor:r,dependencies:n})},e.getCtx=function(){if(e.ctx)return e.ctx;throw new Error("ctx is not set")},e.load=function(t){e.ctx=t,e.loadMockDependencies(t),e.loadModules(t);for(var r=0,n=e.classRegistrations;r<n.length;r++){var i=n[r],o=t.register(i.name).asCtor(i.ctor);i.dependencies&&o.dependencies(i.dependencies)}e.classRegistrations=[]},e.loadMockDependencies=function(e){e.register("Abra:Walkme").asInstance(window._walkMe)},e.loadModules=function(e){e.register("Abra:EventObfuscator").asCtor(r(5).Encoder).dependencies("Abra:JSON"),e.register("Abra:QueryGenerator").asFunction(function(e){var t=r(7)({}),n=r(10)(e,t);return{generate:function(t){return n.generate(e(t))}}}).dependencies("wmjQuery"),e.register("Abra:XpathEscaper").asInstance(r(12).XpathEscaper)},e.classRegistrations=[],e}(),o=function(){function e(e,t,r,n,i,o){this.jQuery=e,this.xPathGenerator=t,this.elementDescriptionGenerator=r,this.meaningfulElementGetter=n,this.commonEventAttributesProvider=i,this.privacyUtils=o}return e.prototype.getLocation=function(e){var t=this.commonEventAttributesProvider.get();return t&&t.ctx&&t.ctx.location},e.prototype.getElementAttributes=function(e){var t=this.privacyUtils.shouldCensorText(null,e);return this.xPathGenerator.getAttributes(this.jQuery(e),R.createKeyValuePair,t)},e.prototype.getElementId=function(e){return this.xPathGenerator.getId(this.jQuery(e))},e.prototype.getElementClasses=function(e){return this.xPathGenerator.getClasses(this.jQuery(e))},e.prototype.getElementText=function(e){if(!this.privacyUtils.shouldCensorText(null,e)){var t=this.meaningfulElementGetter.get(e);return this.elementDescriptionGenerator.getText(t?t.element:e).text}},e.prototype.load=function(){s.AbraObject=this.jQuery.extend(s.AbraObject,{getLocation:this.getLocation.bind(this),getElementAttributes:this.getElementAttributes.bind(this),getElementId:this.getElementId.bind(this),getElementClasses:this.getElementClasses.bind(this),getElementText:this.getElementText.bind(this)})},e}();i.registerClass("Abra:CaptureElementApiLoader",o,"wmjQuery, Abra:XPathGenerator, Abra:ElementDescriptionGenerator, Abra:MeaningfulElementGetter, CommonEventAttributesProvider, Abra:PrivacyUtils");var a=function(){function e(e,t,r,n){var i=this;this.logger=e,this.eventsTrigger=t,this.timingUtils=r,this.lastNotification=null,this.cachedResult=null,this.collectByDefault=!this.isManualMode(n),s.AbraObject.isCollecting=function(){return i.shouldCollect()},this.cleanCachedResultOnNextEventLoop=this.timingUtils.createOnNextEventLoopFunc(function(){i&&(i.cachedResult=null)})}return e.prototype.shouldCollect=function(){if(null!==this.cachedResult)return this.cachedResult;try{this.cachedResult=this.querySite(),null!==this.cachedResult&&this.cleanCachedResultOnNextEventLoop()}catch(e){this.cachedResult=null,this.logger.error("Error on ShouldCollectUserData",e)}var t=null!==this.cachedResult?this.cachedResult:this.collectByDefault;return this.notifyChange(t),t},e.prototype.querySite=function(){var e=window.isWalkmeUserBehaviorDataCollectionEnabled;if(e&&e.constructor&&e.call&&e.apply){var t=e();if(t===!0||t===!1)return t;throw new Error("return value expected to be boolean")}return null},e.prototype.isManualMode=function(e){var t=e.get();return!(!t||!t.loading||"manual"!==t.loading.mode)},e.prototype.notifyChange=function(e){this.lastNotification!==e&&(this.lastNotification=e,this.eventsTrigger.async("UBT:CollectionStatusChanged",{isCollecting:e}))},e}();i.registerClass("Abra:CollectionIndicator",a,"Abra:Logger, EventsTrigger, Abra:TimingUtils, Abra:DataCollectionSettingsWrapper");var s;!function(e){e.App={name:"abra",version:"5.0.54",rev:"d12c1ab"},e.WalkmeInternals=window._walkmeInternals,e.AbraObject={version:e.App.version,rev:e.App.rev};function t(t){e.WalkmeInternals.abraState=t}e.setState=t;function r(r){t("errored"),e.AbraObject.errorInfo=r}e.setErrorInfo=r;function n(e){try{var t=e.get("EventsListener"),n=W.allowOnce(function(){a(e)});t.once("wm.pagescript.envIdInjected",n),t.once("BeforeWalkmeReady",n),w.enable(e),o(e)}catch(i){r({error:i})}return null}e.start=n;function o(e){var t={initializationData:void 0};e.get("EventsListener").once("PageVisitIdUpdated",function(e,r){t.initializationData=r}),e.register("Abra:PageLoadSync").asInstance(t)}function a(n){n.register("Abra:UbtPerformance").asCtor(q).dependencies("PerformanceBILogger"),e.AbraObject.dbg=new c(n).getApi();var o=z.registerLogger(n),a="verify requirements";try{if((e.WalkmeInternals.abra||e.WalkmeInternals.ubt)&&"removed"!==e.WalkmeInternals.abraState)return o.error("Abra was already loaded");e.WalkmeInternals.abra=e.AbraObject,e.WalkmeInternals.ubt=e.AbraObject;var s=n.get("HostData");if(s.isIE()&&!s.isIE(9,"gte"))return r({error:new Error("Browser is not supported")});if(!n.get("AuditingEnabledIndicator").isEnabled())return r({error:new Error("Disabled due to noAudit feature enabled")});var u=o.perf("load");t("preload"),a="load abra to ctx",i.load(n),n.get("EventsTrigger").sync("Abra:CtxLoaded"),a="load abra";var l=!!n.get("IsInEditor").get();n.get("Abra:Loader").load(l).then(function(e){e&&u.stop()})}catch(h){o.error("could not "+a,h),r({error:h})}}}(s||(s={})),e.exports=s;var u=function(){function e(e,t,r,n,i,o,a,s,u,l,c,h,p,d,g,f,v){this.logger=e,this.storageSynchronizer=t,this.eventsSenderWrapper=r,this.eventsTrigger=n,this.jQuery=i,this.userEventCreator=o,this.idleEventCreator=a,this.windowIdGetter=s,this.errorUtils=u,this.frameBinder=l,this.pageInfoCreator=c,this.timingUtils=h,this.eventsListener=p,this.userEventListener=d,this.keypressEventCreator=g,this.captureElementApiLoader=f,this.featuresManager=v,this.isUnloaded=!1}return e.prototype.load=function(e){var t=this;void 0===e&&(e=!1);var r;return s.setState("loading"),this.storageSynchronizer.getStorageKey()["catch"](this.errorUtils.wrapCatch("get storage key")).then(function(){return t.windowIdGetter.load()})["catch"](this.errorUtils.wrapCatch("get winId")).then(function(){return e||(t.errorUtils.wrapCall(function(){return t.eventsSenderWrapper.init(r)},"load sender"),t.errorUtils.wrapCall(function(){return t.frameBinder.load()},"bind frames"),t.errorUtils.wrapCall(function(){return t.userEventCreator.load()},"load event creator"),t.featuresManager.isFeatureEnabled("UbtEnableKeypressEvent")&&t.errorUtils.wrapCall(function(){return t.keypressEventCreator.load()},"load keypress event creator"),t.errorUtils.wrapCall(function(){return t.idleEventCreator.load()},"load idle event creator"),t.errorUtils.wrapCall(function(){return t.pageInfoCreator.load()},"load page info creator")),t.errorUtils.wrapCall(function(){return t.captureElementApiLoader.load()},"load capture element api"),s.WalkmeInternals.removeAbra=function(e){t.unload({message:e||"no error provided"},{failPoint:"API call"})},t.eventsListener.once("removeWalkMe",function(){t.unload({message:"removeWalkMe"},void 0,!0)}),t.disableHeartbeat(),s.setState(e?"silent":"loaded"),t.eventsTrigger.sync("Abra:Ready"),!0})["catch"](function(e){return t.unload(e),!1})},e.prototype.disableHeartbeat=function(){i.getCtx().has("HeartbeatEventSender")&&i.getCtx().get("HeartbeatEventSender").disable()},e.prototype.unload=function(e,t,r){if(void 0===r&&(r=!1),this.isUnloaded===!0)return;s.setState("removing"),s.WalkmeInternals.removeAbra=void 0,this.isUnloaded=!0,t=t?this.jQuery.extend(e.extraData||{},t):e.extraData||{},s.setErrorInfo({error:e,extraData:t});try{this.userEventListener.disable(),this.eventsSenderWrapper.disable(),this.timingUtils.disable(),this.frameBinder.unload(),this.windowIdGetter.unload(),this.userEventCreator.unload(),this.idleEventCreator.unload(),this.pageInfoCreator.unload(),this.keypressEventCreator.unload(),s.setState("removed")}catch(n){this.logger.warn("error unloading abra",n)}t.failPoint=t.failPoint||"unknown reason",r||this.logger.error("abra unload: "+t.failPoint,e,t)},e}();i.registerClass("Abra:Loader",u,"Abra:Logger, Abra:StorageSynchronizer, Abra:EventsSenderWrapper, EventsTrigger, wmjQuery, Abra:UserEventCreator, Abra:IdleEventCreator, Abra:WindowIdGetter, Abra:ErrorUtils, Abra:FrameBinder, Abra:PageInfoCreator, Abra:TimingUtils, EventsListener, Abra:UserEventListener, Abra:KeypressEventCreator, Abra:CaptureElementApiLoader, FeaturesManager");var l=function(){function e(e){this.ctx=e}return e.prototype.get=function(){return{disableEventListeners:this.disableEventListeners.bind(this),disableEventSender:this.disableEventSender.bind(this),disableXpathBuilder:this.disableXpathBuilder.bind(this),disableAutoQuery:this.disableAutoQuery.bind(this),disableMeaningfulElement:this.disableMeaningfulElement.bind(this),disableLabel:this.disableLabel.bind(this),disableText:this.disableText.bind(this),disableIdleActive:this.disableIdleActive.bind(this),enablePerformanceLogs:this.enablePerformanceLogs.bind(this)}},e.prototype.decorateOnLoad=function(e,t){var r=this;this.ctx.get("EventsListener").once("Abra:CtxLoaded",function(){r.ctx.decorate(e,t)})},e.prototype.disableEventListeners=function(){this.decorateOnLoad("Abra:UserEventListener",function(e){return e.register=function(){return-1},e})},e.prototype.disableEventSender=function(){this.decorateOnLoad("Abra:EventsSenderWrapper",function(e){return e.init=function(){return},e.send=function(){return},e})},e.prototype.disableXpathBuilder=function(){this.decorateOnLoad("Abra:XPathGenerator",function(e){return e.generate=function(){return"mock[0]"},e})},e.prototype.disableAutoQuery=function(){this.decorateOnLoad("Abra:QueryGenerator",function(e){return e.generate=function(){return"mock"},e})},e.prototype.disableMeaningfulElement=function(){this.decorateOnLoad("Abra:MeaningfulElementGetter",function(e){return e.get=function(){return},e})},e.prototype.disableLabel=function(){this.decorateOnLoad("Abra:LabelGetter",function(e){return e.get=function(){return"mock"},e})},e.prototype.disableText=function(){this.decorateOnLoad("Abra:ElementDescriptionGenerator",function(e){return e.getText=function(){return{text:"mock"}},e})},e.prototype.disableIdleActive=function(){this.decorateOnLoad("Abra:IdleEventCreator",function(e){return e.load=function(){return},e})},e.prototype.enablePerformanceLogs=function(){var t=this;this.ctx.decorate("Abra:UbtPerformance",function(r){var n;return r.perf=function(r){return n=n||t.ctx.get("Abra:Logger"),e.createPerf(r,n)},r})},e.createPerf=function(e,t){var r=window.performance,n=r.now(),i=n;return{stop:function(){return t.info("performance: "+e+" took "+(r.now()-n).toFixed(2)+" ms")},step:function(o){var a=r.now();t.info("performance: "+e+"-"+o+" time from start "+(a-n).toFixed(2)+" ms (time from last step "+(a-i).toFixed(2)+" ms)"),i=a}}},e}(),c=function(){function e(e){this.enableIndicatorFlag="wm-ubt-dbg",this.storage=window.localStorage,this.storage&&this.checkFlag(this.enableIndicatorFlag)&&(this.options=new l(e).get(),this.activateFlags(),this.api=this.createApi())}return e.prototype.getApi=function(){return this.api},e.prototype.activateFlags=function(){for(var e in this.options)this.options.hasOwnProperty(e)&&this.checkFlag(this.getFlagName(e))&&this.options[e]()},e.prototype.getFlagName=function(e){return this.enableIndicatorFlag+"-"+e},e.prototype.checkFlag=function(e){return"true"===this.storage[e]},e.prototype.toggleFlag=function(e){return this.storage[e]=!this.checkFlag(e),this.checkFlag(e)},e.prototype.clearFlag=function(e){this.storage.removeItem(e)},e.prototype.createApi=function(){var e=this,t={},r=function(r){n.options.hasOwnProperty(r)&&(t[r]=function(){return e.toggleFlag(e.getFlagName(r))})},n=this;for(var i in this.options)r(i);return t.clear=function(){for(var t in e.options)e.options.hasOwnProperty(t)&&e.clearFlag(e.getFlagName(t));e.clearFlag(e.enableIndicatorFlag)},t},e}(),h=function(){function e(e,t,r,n){this.logger=e,this.jQuery=t,this.errorUtils=r,this.featuresManager=n,this.get=r.bindCall(this,this.get,"error getting element parents"),this.useJQueryParent=n.isFeatureEnabled("Abra-Use-JQuery-Parent")}return e.prototype.get=function(e){var t=e.path||e.composedPath&&e.composedPath()||[],r=p.isElement(t[0])?t[0]:e.target;if(!p.isElement(r))throw new Error("unexpected event target type: "+typeof r);return this.getFromElement(r)},e.prototype.getFromElement=function(t){var r,n=[],i=e.MaxClimbCount,o=t;do if(p.isElement(o)&&n.unshift(o),r=o,o=this.getParent(o),--i<=0)throw new Error("ElementParentsGetter loop reached its limit");while(o&&r!==o);return n},e.prototype.getParent=function(e){if(p.isDocument(e))return this.tryGetFrameElement(e);return this.useJQueryParent?this.jQuery(e).parent()[0]:this.getParentElementDefault(e)},e.prototype.getParentElementDefault=function(e){if(e.assignedSlot)return e.assignedSlot;if(e.parentNode)return e.parentNode;if(e.host)return e.host},e.prototype.tryGetFrameElement=function(e){try{var t=e.defaultView||e.parentWindow;if(t&&this.shouldClimbMore(t))return t.frameElement}catch(r){this.logger.error("error getting frame element",r)}},e.prototype.shouldClimbMore=function(e){try{return!e._makeTutorial}catch(t){return!1}},e.MaxClimbCount=1e3,e}();i.registerClass("Abra:ElementParentsGetter",h,"Abra:Logger, wmjQuery, Abra:ErrorUtils, FeaturesManager");var p=function(){function e(){}return e.isElementTextNode=function(e){return e.nodeType===ue.Text||e.nodeType===ue.CDATASection},e.isVisualDomElement=function(e){var t=e.nodeType===ue.Element&&!e.tagName.match(/^(script|style)$/i);return t},e.isElement=function(e){return e&&e.nodeType===ue.Element},e.isDocument=function(e){return e&&(e.nodeType===ue.Document||e.nodeType===ue.DocumentType)},e.getLowerCaseTagName=function(e){return(e.nodeName||e.localName).toLowerCase()},e}(),d=function(){function e(e,t){this.hostData=e,this.jQuery=t}return e.prototype.get=function(e){var t=this.getLabelElement(e);return t&&t.textContent&&oe.trim(t.textContent)},e.prototype.getLabelElement=function(e){var t=e.labels&&e.labels[0];if(t)return t;return this.getLabelElementIePolyfill(e)},e.prototype.getLabelElementIePolyfill=function(t){if((this.hostData.isIE()||this.hostData.isEdge())&&this.jQuery.inArray(p.getLowerCaseTagName(t),e.polyfillElementTypes)!==-1){var r=this.jQuery(t),n=r.attr("id");if(n&&"string"==typeof n){var i=this.jQuery('label[for="'+oe.escapeJQuerySelectorAttributeValue(n)+'"]',t.ownerDocument);if(0!==i.length)return i[0]}return r.closest("label")[0]}},e.polyfillElementTypes=["input","textarea","button","select","output"],e}();i.registerClass("Abra:LabelGetter",d,"HostData, wmjQuery");var g=function(){function e(e,t,r,n,i,o,a,s,u){this.jQuery=e,this.privacyUtils=t,this.textUtils=r,this.logger=n,this.xpathGenerator=i,this.queryGenerator=o,this.labelGetter=a,this.featuresManager=s,this.overlappedText=u,this.textOptions={maxLength:200}}return e.prototype.generate=function(e,t){var r=this.logger.perf("capture"),n={},i={desc:n},o=e.getParents();r.step("getParents");var a=this.privacyUtils.shouldCensorText(o);r.step("shouldCensorText");try{n.xpath=this.generateXpath(e,a),r.step("generateXpath")}catch(s){this.logger.error("cannot generate xpath",s)}var u=e.getElement(),l=t||u;try{n.autoQuery=this.queryGenerator.generate(l),r.step("generateAutoQuery")}catch(s){this.logger.error("cannot generate autoQuery",s)}if(!a&&(n.label=this.labelGetter.get(l),r.step("getLabel"),!this.privacyUtils.isPrivacyUnsafeElementType(l))){var c=this.getText(l,!0);r.step("getText"),n.text=c.text,c.isOverlapped&&(i.misc={textSource:"overlapped"});var h=this.jQuery(l).val();n.value=h?oe.trim(h.toString(),this.textOptions.maxLength):void 0}return r.stop(),i},e.prototype.generateXpath=function(e,t){var r=e.getParents();return t=void 0!==t?t:this.privacyUtils.shouldCensorText(r),this.xpathGenerator.generate(r,t)},e.prototype.getSelectTagText=function(e){var t=this.jQuery(e),r=t.val();if("string"==typeof r&&r.indexOf("\n")===-1)return t.find('option[value="'+oe.escapeJQuerySelectorAttributeValue(r)+'"]').text()},e.prototype.getElementText=function(e,t){if(void 0===t&&(t=!1),!t&&(this.privacyUtils.isPrivacyUnsafeElementType(e)||this.privacyUtils.shouldCensorText(null,e)))return;if("select"===p.getLowerCaseTagName(e))return this.getSelectTagText(e);return oe.trim(this.textUtils.collectText(e,this.textOptions),this.textOptions.maxLength)},e.prototype.getText=function(e,t){void 0===t&&(t=!1);var r={};if(r.text=this.getElementText(e,t),!r.text&&this.featuresManager.isFeatureEnabled("UbtAddOverlappedText"))try{var n=this.overlappedText.getOverlappedTextElement(e);n&&(r.text=this.getElementText(n,!1),r.isOverlapped=!0)}catch(i){this.logger.error("cannot get overlapped text",i)}return r},e}();i.registerClass("Abra:ElementDescriptionGenerator",g,"wmjQuery, Abra:PrivacyUtils, Abra:TextUtils, Abra:Logger, Abra:XPathGenerator, Abra:QueryGenerator, Abra:LabelGetter, FeaturesManager, Abra:OverlappedText");var f=function(){function e(){}return e.getElementFirstAncestors=function(t){for(var r=[],n=t.parentElement,i=0;n&&i<e.maxDistToParent;)r.push(n),i++,n=n.parentElement;return r},e.isMaxDistanceToCommonAncestorExceeded=function(t,r){var n=t.length-1,i=r.length-1;if(t[n]!==r[i])return!0;for(;n>=0&&i>=0&&t[n]===r[i];)n--,i--;var o=n+2,a=i+2;return o>e.maxDistToParent||a>e.maxDistToParent},e.getElementCenter=function(e){var t=e.getBoundingClientRect(),r=t.left,n=t.right,i=t.top,o=t.bottom;return{x:(n+r)/2,y:(o+i)/2}},e.isPositiveZIndex=function(t){for(var r=t,n=0;r&&n<e.maxDistToParent;){if(parseInt(getComputedStyle(r).zIndex)>0)return!0;n++,r=r.parentElement}return!1},e.getElementsAtPoint=function(e,t,r){if(e.elementsFromPoint)return e.elementsFromPoint(t,r);var n=e.msElementsFromPoint(t,r),i=[];if(null!==n)for(var o=0;o<n.length;o++)i.push(n[o]);return i},e.getElementDescendantsNum=function(t,r){if(void 0===r&&(r=0),r>e.maxDescendants)return 1/0;var n=t.children;if(0===n.length)return 0;var i=n.length;if(r+i>e.maxDescendants)return 1/0;for(var o=0;o<n.length;o++){var a=e.getElementDescendantsNum(n[o],r+i);if(i+=a,r+i>e.maxDescendants)return 1/0}return i},e.isElementHasTooMuchDescendants=function(t){return e.getElementDescendantsNum(t)>e.maxDescendants},e.isElementHasInnerText=function(e){var t=e.innerText;return t&&(t=t.trim()),!!t},e.prototype.getOverlappedTextElement=function(t){if(!e.isPositiveZIndex(t))return;for(var r,n=e.getElementCenter(t),i=n.x,o=n.y,a=e.getElementsAtPoint(t.ownerDocument,i,o),s=e.getElementFirstAncestors(t),u=0;u<a.length&&!r;u++){var l=a[u];if(s.indexOf(l)>-1||l===t)continue;if(!e.isElementHasInnerText(l))continue;var c=e.getElementFirstAncestors(l);if(e.isMaxDistanceToCommonAncestorExceeded(s,c))continue;if(e.isElementHasTooMuchDescendants(l))continue;r=l}return r},e.maxDistToParent=3,e.maxDescendants=6,e}();i.registerClass("Abra:OverlappedText",f);var v=function(){function e(e){this.jQuery=e}return e.prototype.get=function(t){var r=this.jQuery(t),n=void 0,i=!0,o=-1;do{if(r[0].shadowRoot)break;if(o++,"button"===p.getLowerCaseTagName(r[0])){n={type:"button",element:r[0],climb:o};break}if(i===!0){var a=this.getElementCursor(r);this.isPointer(r,a)?n={type:"pointer",element:r[0],climb:o}:i=this.isCursorCouldBePointer(r[0],a)}void 0===n&&this.isStoppableAttribute(r[0])&&(n={type:"attribute",element:r[0],climb:o}),r=r.parent()}while(o<e.MaxClimbCount&&r.prop("nodeType")===ue.Element);if(void 0!==n&&n.climb>0&&void 0!==n.element&&n.element!==t)return n},e.prototype.isStoppableAttribute=function(e){if(!e||!e.attributes)return!1;var t=e.attributes.tabIndex;if(t&&t.value&&e.tabIndex>=0)return!0;return t=e.attributes.accesskey,!(!t||!t.value)},e.prototype.getElementCursor=function(e){try{return this.jQuery(e).css("cursor")}catch(t){return"auto"}},e.prototype.isPointer=function(e,t){if("pointer"===t)return!0;if("auto"!==t)return!1;switch(p.getLowerCaseTagName(e[0])){case"a":return void 0!==e.attr("href");default:return!1}},e.prototype.isCursorCouldBePointer=function(t,r){if("pointer"===r)return!0;if("auto"!==r)return!1;return this.jQuery.inArray(p.getLowerCaseTagName(t),e.cursorOverrideNotPointer)===-1},e.cursorOverrideNotPointer=["select","input","button","textarea","video","audio","label"],e.MaxClimbCount=1e3,e}();i.registerClass("Abra:MeaningfulElementGetter",v,"wmjQuery");var m=function(){function e(e,t,r,n,i){this.jQuery=e,this.dataCollectionSettings=t,this.xpathEscaper=r,this.urlCensorshipController=n,this.xpathReducer=i,this.textProperties=R.convertArrayToObject(["name","title"]),this.attributesToCollect=this.getAttributesToCollect(t.get()),this.settings=t.get().element.xpath,this.attributeFormatter=this.attributeFormatter.bind(this)}return e.prototype.getAttributesToCollect=function(e){var t=e.element&&e.element.attributesToCollect;if(t&&0!==t.length){var r=t.slice();return this.urlCensorshipController.shouldCensorUrl()&&(r=this.filterAttributesByCensorship(r)),r.sort(),r}},e.prototype.filterAttributesByCensorship=function(e){var t=this,r=["src","href"];return this.jQuery.grep(e,function(e){return t.jQuery.inArray(e,r)===-1})},e.prototype.generate=function(e,t){void 0===t&&(t=!1);var r=this.generateXpathParts(e,t),n=this.convertXpathToStringArray(r);return this.applyXpathLengthLimitation(n).join("")},e.prototype.generateXpathParts=function(e,t){var r=this;return this.jQuery(e).map(function(e,n){var i=r.jQuery(n);return{tagName:p.getLowerCaseTagName(n),tagIndex:r.getTagIndex(n),classes:r.getClasses(i),id:r.getId(i),attributes:r.getAttributes(i,r.attributeFormatter,t)}}).toArray()},e.prototype.getAttributes=function(t,r,n){var i=this,o=[];return this.attributesToCollect&&this.xpathReducer.shouldCollectAttributesOrClasses(t)&&this.jQuery.each(this.attributesToCollect,function(a,s){if(n&&i.textProperties[s])return;var u=t.attr(s);if(void 0!==u){var l=i.attributesToCollect[a];u.length<=i.settings.attributeMaxLength&&e.shouldCollectAttribute(u)?o.push(r(l,u)):o.push(r(l))}}),o},e.prototype.getClasses=function(t){var r=this,n=[];if(this.xpathReducer.shouldCollectAttributesOrClasses(t)){var i=t.attr("class");i&&(n=this.jQuery.grep(i.split(e.classDelimiter),e.shouldCollectClassOrId),n=this.jQuery.map(n,function(e){return oe.trim(e)}),n=this.jQuery.grep(n,function(e){return e&&e.length<=r.settings.classMaxLength}),n.sort())}return n},e.prototype.getId=function(t){var r=t.attr("id");if(e.shouldCollectClassOrId(r)){var n=oe.trim(r);if(n.length<=this.settings.idMaxLength)return n}},e.prototype.convertXpathToStringArray=function(t){for(var r=[],n=0;n<t.length;n++){var i=t[n];if(r.push(i.tagName),r.push("["),r.push((i.tagIndex+1).toString()),r.push("]"),i.id&&(r.push("#"),r.push(i.id)),i.classes){var o=this.jQuery.map(i.classes,function(e){return"."+e});r.push.apply(r,o)}i.attributes&&r.push.apply(r,i.attributes),r.push(e.delimiter)}return r.pop(),r},e.prototype.attributeFormatter=function(e,t){return t?"&"+e+"="+this.xpathEscaper.escape(t):"&"+e},e.prototype.applyXpathLengthLimitation=function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r].length;for(var r=0;t>this.settings.xpathMaxLength&&r<e.length;r++){var n=e[r];"."===n[0]&&(t-=n.length,e[r]="")}if(t>this.settings.xpathMaxLength){for(var i=0,o=0,r=0;r<e.length&&0===o;r++){var n=e[r];i+=n.length,"/"===n&&t-i<=this.settings.xpathMaxLength&&(o=r)}e=0!==o?e.slice(o+1):[]}return e},e.prototype.getTagIndex=function(e){for(var t=0,r=e.previousSibling;r;r=r.previousSibling)r.localName===e.localName&&t++;return t},e.shouldCollectClassOrId=function(t){return t&&!e.forbiddenCharsRegex.test(t)},e.shouldCollectAttribute=function(e){return e&&!V.isCreditCard(e)},e.forbiddenCharsRegex=/[&=\.\]\[\/\#]/,e.classDelimiter=/[\s\uFEFF\xA0]+/,e.delimiter="/",e}();i.registerClass("Abra:XPathGenerator",m,"wmjQuery, Abra:DataCollectionSettingsWrapper, Abra:XpathEscaper, Abra:UrlCensorshipController, Abra:XpathReducer");var b=function(){function e(){}return e.prototype.shouldCollectAttributesOrClasses=function(e){if(e&&p.isElement(e[0])){var t=p.getLowerCaseTagName(e[0]);return"html"!==t&&"body"!==t}return!0},e}();i.registerClass("Abra:XpathReducer",b);var y=function(){function e(e,t,r,n,o,a,s,u,l,c,h,p){this.eventBuilder=e,this.eventsSenderWrapper=t,this.eventsTrigger=r,this.logger=n,this.windowIdGetter=o,this.commonEventAttributesProvider=a,this.jQuery=s,this.obfuscator=u,this.textValueCensorship=l,this.collectionIndicator=c,this.webhooksIdsAdder=h,this.shouldEncode=!0,this.shouldEncode=!p.isFeatureEnabled("Abra-DisableEncoding"),i.getCtx().has("CleanObject")&&(this.cleanObject=i.getCtx().get("CleanObject"))}return e.prototype.initiate=function(e){var t=this;if(!this.collectionIndicator.shouldCollect())return;var r=ae.now();this.eventBuilder.build(e).then(function(n){return n.time=r,n.ctx=n.ctx||{},t.addTimingData(n),t.addIframeData(n),t.addApplicationData(n),t.addWindowData(n).then(function(){t.substringEvent(n),t.textValueCensorship.censorEvent(e),n=t.jQuery.extend(!0,n,t.commonEventAttributesProvider.get()),t.cleanObject&&(n=t.cleanObject(n)),t.webhooksIdsAdder&&t.webhooksIdsAdder.add(n),t.sendEvent(n)})})["catch"](function(e){t.logger.error("error sending event",e)})},e.prototype.substringEvent=function(e){oe.substringObject(re.Value,e)},e.prototype.addTimingData=function(e){e.ctx.timing=ae.getTimingData()},e.prototype.addWindowData=function(e){return this.windowIdGetter.getOrCreate().then(function(t){e.ctx.winId=t})},e.prototype.addIframeData=function(e){try{G.isIframe()&&(e.ctx.topTitle=G.getTopTitle())}catch(t){}},e.prototype.addApplicationData=function(e){e.version={abra:s.App.version}},e.prototype.sendEvent=function(e){this.eventsSenderWrapper.send(this.shouldEncode?this.obfuscator.encode(e):e),this.eventsTrigger.sync("Abra:EventSent",e),this.logger.debug(e)},e}();i.registerClass("Abra:EventHandler",y,"Abra:EventBuilder, Abra:EventsSenderWrapper, EventsTrigger, Abra:Logger, Abra:WindowIdGetter, CommonEventAttributesProvider, wmjQuery, Abra:EventObfuscator, Abra:TextValueCensorship, Abra:CollectionIndicator, WebhooksIdsAdder, FeaturesManager");var E={active:"active",idle:"idle",pageChange:"pageChange"},C=function(){function e(e,t,r,n,i){this.eventHandler=e,this.userEventListener=t,this.reusableTimerFactory=r,this.errorUtils=n,this.throttle=i,this.delay=6e4,this.isIdle=!1,this.isEnabled=!1,this.throttleIntervalMS=1e3}return e.prototype.load=function(){var e=this;this.timer||(this.timer=this.reusableTimerFactory.create(function(){return e.setIdle()},this.delay),this.registerId=this.userEventListener.register(this.throttle(function(t){return e.setActive(t)},this.throttleIntervalMS),["blur","change","click","dblclick","focus","focusin","focusout","hover","keydown","keypress","keyup","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","resize","scroll","select","submit"]),this.timer.set(),this.isEnabled=!0)},e.prototype.unload=function(){this.timer&&(this.userEventListener.unregister(this.registerId),this.timer.clear(),this.isEnabled=!1)},e.prototype.setDelay=function(e){this.delay=e},e.prototype.setThrottleInterval=function(e){this.throttleIntervalMS=e},e.prototype.setActive=function(e){this.isEnabled&&(this.isIdle&&(this.isIdle=!1,this.raiseEvent(E.active,e.getEventType())),this.timer.set())},e.prototype.setIdle=function(){this.isEnabled&&(this.isIdle=!0,this.raiseEvent(E.idle))},e.prototype.raiseEvent=function(e,t){var r=this;this.errorUtils.wrapCallAndLog(function(){r.eventHandler.initiate({event:{type:e,misc:{trigger:t}}})},"error at IdleEventCreator",{type:e,trigger:t})},e}();i.registerClass("Abra:IdleEventCreator",C,"Abra:EventHandler, Abra:UserEventListener, Abra:ReusableTimerFactory, Abra:ErrorUtils, Throttle");var x=function(){function e(e,t,r,n,i,o,a){var s=this;this.userEventListener=e,this.errorUtils=t,this.eventHandler=r,this.reusableTimerFactory=n,this.elementDescriptionGenerator=i,this.textValueCensorship=o,this.collectionIndicator=a,this.isEnabled=!1,this.timer=this.reusableTimerFactory.create(function(){return s.feedEvent()},1e3)}return e.prototype.load=function(){var e=this;this.isEnabled||(this.registerId=this.userEventListener.register(function(t){return e.feedEvent(t)},["keypress"]),this.registerBeforeUnload(),this.isEnabled=!0)},e.prototype.unload=function(){this.isEnabled&&(this.timer.clear(),this.userEventListener.unregister(this.registerId),this.eventData=void 0,this.isEnabled=!1)},e.prototype.feedEvent=function(e){if(!this.isEnabled)return;e&&this.collectionIndicator.shouldCollect()?this.eventData?this.eventData.desc.xpath===this.elementDescriptionGenerator.generateXpath(e)?(this.timer.set(),this.eventData.count++):(this.raiseEvent(),this.createNew(e)):this.createNew(e):this.raiseEvent()},e.prototype.createNew=function(e){this.eventData={desc:this.elementDescriptionGenerator.generate(e).desc,censorshipData:this.textValueCensorship.createCensorshipData(e),count:1,t1:ae.now()},this.timer.set()},e.prototype.raiseEvent=function(){this.timer.clear(),this.eventData&&(this.eventHandler.initiate({event:{type:"keypress",element:this.eventData.desc,misc:{count:this.eventData.count,t1:this.eventData.t1}},data:{censorshipData:this.eventData.censorshipData}}),this.eventData=void 0)},e.prototype.registerBeforeUnload=function(){var e=this,t=window.onbeforeunload;window.onbeforeunload=function(r){if(e.isEnabled&&e.errorUtils.wrapCallAndLog(function(){return e.feedEvent()},"error on onbeforeunload keypress"),t)return t.call(window,r)}},e}();i.registerClass("Abra:KeypressEventCreator",x,"Abra:UserEventListener, Abra:ErrorUtils, Abra:EventHandler, Abra:ReusableTimerFactory, Abra:ElementDescriptionGenerator, Abra:TextValueCensorship, Abra:CollectionIndicator");var A=function(){function e(e,t,r,n,o){var a=this;this.logger=e,this.pageVisitIdProvider=t,this.eventHandler=r,this.pageLoadSync=n,this.eventsListener=o,this.disabledByWalkmePlayer=i.getCtx().has("PageChangeEventSender"),this.eventCallback=function(){return a.distribute()}}return e.prototype.distribute=function(){this.eventHandler.initiate({event:{type:E.pageChange}})},e.prototype.load=function(){if(this.disabledByWalkmePlayer)return;this.pageLoadSync.initializationData&&(this.pageVisitIdProvider.get()!==this.pageLoadSync.initializationData.id&&this.logger.error("Data inconsistency in pageVisitId"),this.distribute()),this.eventsListener.on("PageVisitIdUpdated",this.eventCallback)},e.prototype.unload=function(){if(this.disabledByWalkmePlayer)return;this.eventsListener.off("PageVisitIdUpdated",this.eventCallback)},e}();i.registerClass("Abra:PageInfoCreator",A,"Abra:Logger, PageVisitIdProvider, Abra:EventHandler, Abra:PageLoadSync, EventsListener");var w=function(){function e(){}return e.enable=function(e){e.get("EventsListener").once("EventSenderContextDataProviderReferrerEnablement",function(){return!0})},e}(),T=function(){function e(e,t){this.jQuery=e,this.compatibilityUtils=t,this.initBindingFunctions()}return e.prototype.initBindingFunctions=function(){var e;i.getCtx().has("NativeEventListenerFunctionsProvider")&&(e=i.getCtx().get("NativeEventListenerFunctionsProvider").get()),
e=e||{},this.addEventListener=e.addEventListener||document.addEventListener,this.removeEventListener=e.removeEventListener||document.removeEventListener},e.prototype.bindEvents=function(e,t,r){var n=this,i=function(t){return n.jQuery(e).on(t+".abra",r)},o=i;this.compatibilityUtils.isCaptureBindCompatible()&&(o=function(t){try{n.addEventListener.apply(e,[t,r,!0])}catch(o){i(t)}}),this.jQuery.each(t,function(e,t){o(t)})},e.prototype.unbindEvents=function(e,t,r){var n=this,i=function(t){try{n.removeEventListener.apply(e,[t,r,!0]),n.jQuery(e).off(t+".abra",r)}catch(i){}};this.jQuery.each(t,function(e,t){i(t)})},e}();i.registerClass("Abra:UserEventBinder",T,"wmjQuery, Abra:CompatibilityUtils");var L=function(){function e(e,t,r,n,i,o,a,s){this.userEventListener=e,this.eventHandler=t,this.elementDescriptionGenerator=r,this.jQuery=i,this.errorUtils=o,this.textValueCensorship=a,this.collectionIndicator=s,this.generateElementDescription=this.errorUtils.bindCall(this.elementDescriptionGenerator,this.elementDescriptionGenerator.generate,"element capture"),this.meaningfulElementGetter=this.errorUtils.bindCall(this,function(e,t){if("mousedown"===e||"dblclick"===e)return n.get(t)},"meaningful element")}return e.prototype.createEvent=function(e){if(!this.collectionIndicator.shouldCollect())return;var t=e.getElement(),r=e.getEventType();if(!t||!this.shouldCreateEvent(t,r))return;var n,i=this.meaningfulElementGetter(r,t);i&&(n={type:i.type,climb:i.climb});var o=i?i.element:t,a=this.generateElementDescription(e,o),s=a.desc,u=a.misc;u&&(n=this.jQuery.extend(u,n)),this.eventHandler.initiate({event:{type:r,element:s,misc:n},data:{event:e,censorshipData:this.textValueCensorship.createCensorshipData(e)}})},e.prototype.shouldCreateEvent=function(t,r){if(this.jQuery.inArray(p.getLowerCaseTagName(t),e.BlockedTags)!==-1)return!1;if(this.jQuery.inArray(r,["mousedown","dblclick"])!==-1&&t.textContent&&t.textContent.length>e.MaxTextContent)return!1;return!0},e.prototype.load=function(){var e=this;this.registerId=this.userEventListener.register(function(t){return e.createEvent(t)},["change","mousedown","dblclick","submit"])},e.prototype.unload=function(){this.userEventListener.unregister(this.registerId)},e.BlockedTags=["html","body"],e.MaxTextContent=250,e}();i.registerClass("Abra:UserEventCreator",L,"Abra:UserEventListener, Abra:EventHandler, Abra:ElementDescriptionGenerator, Abra:MeaningfulElementGetter, wmjQuery, Abra:ErrorUtils, Abra:TextValueCensorship, Abra:CollectionIndicator");var I=function(){function e(e,t,r,n){var i=this;this.userEventBinder=e,this.frameBinder=t,this.errorUtils=r,this.userEventWrapper=n,this.runningCallbackId=-1,this.distributeMap={},this.unregisterData={},this.enabled=!0,this.mainCallback=function(e){return i.distribute(e)}}return e.prototype.register=function(e,t){for(var r=++this.runningCallbackId,n=[],i=0;i<t.length;i++){var o=t[i];this.distributeMap[o]?this.distributeMap[o].push(e):(this.distributeMap[o]=[e],n.push(o))}return this.bind(n,this.mainCallback),this.unregisterData[r]={callback:e,events:t},r},e.prototype.unregister=function(e){var t=this.unregisterData[e];if(!t)return!1;for(var r=[],n=0;n<t.events.length;n++)for(var i=t.events[n],o=this.distributeMap[i],a=0;a<o.length;a++)if(o[a]===t.callback){o.splice(a,1),0===o.length&&(r.push(i),delete this.distributeMap[i]);break}return this.unbind(r,this.mainCallback),delete this.unregisterData[e],!0},e.prototype.disable=function(){this.enabled=!1},e.prototype.distribute=function(e){var t=this;if(this.enabled)for(var r=this.distributeMap[e.type]||[],n=function(n){i.errorUtils.wrapCallAndLog(function(){return r[n](t.userEventWrapper.wrap(e))},"error distributing event",{trigger:e.type})},i=this,o=0;o<r.length;o++)n(o)},e.prototype.bind=function(e,t){var r=this;this.frameBinder.forEach(function(n){r.userEventBinder.bindEvents(n,e,t)})},e.prototype.unbind=function(e,t){var r=this;this.frameBinder.forEach(function(n){r.userEventBinder.unbindEvents(n,e,t)})},e}();i.registerClass("Abra:UserEventListener",I,"Abra:UserEventBinder, Abra:FrameBinder, Abra:ErrorUtils, Abra:UserEventWrapper");var D=function(){function e(e){this.elementParentsGetter=e}return e.prototype.wrap=function(e){return new P(this.elementParentsGetter,e)},e}(),P=function(){function e(e,t){this.elementParentsGetter=e,this.event=t}return e.prototype.getParents=function(){return this.parents=this.parents||this.elementParentsGetter.get(this.event),this.parents},e.prototype.getElement=function(){var e=this.getParents();return e[e.length-1]},e.prototype.getEvent=function(){return this.event},e.prototype.getEventType=function(){return this.event.type},e}();i.registerClass("Abra:UserEventWrapper",D,"Abra:ElementParentsGetter");var S=function(){function e(e){this.jQuery=e}return e.prototype.get=function(){var e=this;return{classInElementTree:function(t,r){return e.classInElementTree(t,r)},idInElementTree:function(t,r){return e.idInElementTree(t,r)}}},e.prototype.classInElementTree=function(e,t){e.compiled||(e.compiled=this.convertClassArrayToRegex(e.values));for(var r=t.length-1;r>=0;r--){var n=this.jQuery(t[r]).attr("class");if(n&&e.compiled.test(n))return!0}return!1},e.prototype.convertClassArrayToRegex=function(e){var t=[];return this.jQuery.each(e,function(e,r){var n=oe.escapeRegExp(r);t.push("(^|[\\s\\uFEFF\\xA0]{1})"+n+"($|[\\s\\uFEFF\\xA0]{1})")}),new RegExp(t.join("|"),"i")},e.prototype.idInElementTree=function(e,t){if(this.isIdsExistInElementArray(t,e.values))return!0;return!1},e.prototype.isIdsExistInElementArray=function(e,t){for(var r=0;r<e.length;r++)for(var n=0;n<t.length;n++)if(e[r].id===t[n])return!0;return!1},e}();i.registerClass("Abra:CensorshipConditionsGetter",S,"wmjQuery");var M=function(){function e(e,t,r,n){this.jQuery=e,this.logger=t,this.censorshipRules=this.getCensorshipRules(n.get()),this.conditionDictionary=r.get()}return e.prototype.getCensorshipRules=function(e){var t=e&&e.element&&e.element.censorshipRules;return t||[]},e.prototype.provide=function(e){for(var t={},r=this.censorshipRules.length-1;r>=0;r--)if(this.conditionDictionary[this.censorshipRules[r].type]){if(this.conditionDictionary[this.censorshipRules[r].type](this.censorshipRules[r],e)){var n=this.censorshipRules[r].methods;n&&n.length>0&&this.jQuery.each(n,function(e,r){t[r]=!0})}}else this.logger.error("censorship type does not exist: "+this.censorshipRules[r].type);return t},e}();i.registerClass("Abra:CensorshipMethodsProvider",M,"wmjQuery, Abra:Logger, Abra:CensorshipConditionsGetter, Abra:DataCollectionSettingsWrapper");var F=function(){function e(e){this.privacyUtils=e,this.propertiesToIgnore=R.convertArrayToObject(["xpath"])}return e.prototype.censorEvent=function(e){var t=e.event;if(t.element){if(this.privacyUtils.removeInputValues&&("keypress"===t.type||"change"===t.type)){var r=e.data&&e.data.censorshipData&&e.data.censorshipData.tagName;"select"!==r&&(t.element.value=void 0,t.element.text=void 0)}t.element=this.privacyUtils.filterCreditCard(t.element,this.propertiesToIgnore)}},e.prototype.createCensorshipData=function(e){return{tagName:p.getLowerCaseTagName(e.getElement())}},e}();i.registerClass("Abra:TextValueCensorship",F,"Abra:PrivacyUtils");var U;!function(e){e[e.Creating=0]="Creating",e[e.Altering=1]="Altering",e[e.Finalizing=1e3]="Finalizing"}(U||(U={}));var j=function(){function e(e,t,r){this.promiseManager=e,this.jQuery=t,this.logger=r,this.providers=[],this.providersCount=0}return e.prototype.build=function(t){var r=this;if(0===this.providersCount)return this.promiseManager.resolve(t.event);return this.jQuery(e.ProvidersTypeOrder).reduce(function(e,n){return e.then(function(){return r.runProvidersGroup(t,r.providers[n])})},this.promiseManager.resolve()).then(function(){return t.event})},e.prototype.runProvidersGroup=function(e,t){var r=this,n=[];if(t)for(var i=function(i){var a=t[i];try{var s=a.handler(e);if(s){var u=s["catch"](function(e){r.logger.error("failed to run provider",e,{providerName:a.name,promise:!0})});n.push(u)}}catch(l){o.logger.error("failed to run provider",l,{providerName:a.name})}},o=this,a=0;a<t.length;a++)i(a);return this.promiseManager.all(n)},e.prototype.register=function(e,t,r){void 0===r&&(r=U.Creating),this.providers[r]=this.providers[r]||[],this.providers[r].push({name:e,handler:t}),this.providersCount++},e.ProvidersTypeOrder=[U.Creating,U.Altering,U.Finalizing],e}();i.registerClass("Abra:EventBuilder",j,"PromiseManager, wmjQuery, Abra:Logger");var k=function(){function e(e){this.walkme=e}return e.prototype.isCaptureBindCompatible=function(){var e=this.walkme.getHostData();return e.isIE(9,"gte")||!e.isIE()},e}();i.registerClass("Abra:CompatibilityUtils",k,"Abra:Walkme");var O=function(){function e(e,t,r){this.promiseManager=e,this.jQuery=t,this.logger=r}return e.prototype.wrapCatch=function(e){var t=this;return function(r){return t.promiseManager.reject(t.wrapError(r,e))}},e.prototype.wrapCall=function(e,t){try{return e()}catch(r){throw this.wrapError(r,t)}},e.prototype.bindCall=function(e,t,r){void 0===e&&(e=null);var n=this;return function(){try{return t.apply(e,arguments)}catch(i){throw n.wrapError(i,r)}}},e.prototype.wrapCallAndLog=function(e,t,r){try{return e()}catch(n){n=this.wrapError(n,r),this.logger.error(t,n,n.extraData)}},e.prototype.wrapError=function(e,t){var r="string"==typeof e?{message:e}:e||{message:"no error provided"};return t="string"!=typeof t?t||{}:{failPoint:t},r.extraData=this.jQuery.extend(t,r.extraData),r},e}();i.registerClass("Abra:ErrorUtils",O,"PromiseManager, wmjQuery, Abra:Logger");var Q=function(){function e(e){this.eventsSenderFactory=e}return e.prototype.init=function(e){var t={name:"Abra",postEventAction:"/event/tell",storageConfig:{keyName:e,autoSave:!1,expiresSeconds:600},stagingStorageConfig:{keyName:e+"-s",autoSave:!1,expiresSeconds:600},failureStorageConfig:{keyName:e+"-f",autoSave:!0,expiresSeconds:86400},storageType:"session",dataSender:"accumulation",clientStorageManager:"ArrayBuffer",clientStagingStorageManager:"ArrayBuffer"};this.sender=this.eventsSenderFactory.generateAndGetEventsSender(t),this.sender.enable()},e.prototype.disable=function(){this.sender&&(this.sender.sleep(),this.sender.disable(),this.sender=void 0)},e.prototype.send=function(e){this.sender&&this.sender.send(e)},e}();i.registerClass("Abra:EventsSenderWrapper",Q,"EventsSenderFactory");var N=function(){function e(e,t,r,n){this.iFramesManager=e,this.uIChangeTracker=t,this.featuresManager=r,this.logger=n}return e.prototype.load=function(){var t=this;if(this.isSpa()||this.iFramesManager.mapIframes(),this.featuresManager.isFeatureEnabled("Abra-ObserveIframes"))try{this.iframeObserver=new B(e.IframeObserverMaxDrillDown),this.iframeObserver.observe(function(){t.iFramesManager.remapTopIframes()},function(e){t.logger.error("iframe mutation observer callback error",e)})}catch(r){this.logger.error("error observing iframe mutations",r)}},e.prototype.unload=function(){this.iframeObserver&&(this.iframeObserver.disconnect(),this.iframeObserver=void 0)},e.prototype.forEach=function(e){var t=this;e(document);try{var r=function(r){var n=r.documentAccessible&&t.getDocument(r.iframe);n&&e(n)};this.iFramesManager.foreachIframe(r,!0),this.iFramesManager.onIframeLoad(r)}catch(n){}},e.prototype.getDocument=function(e){try{var t=e.contentWindow&&e.contentWindow.document;return t=t||e.contentWindow&&e.contentWindow.window&&e.contentWindow.window.document,t=t||e.contentDocument}catch(r){}},e.prototype.isSpa=function(){return this.uIChangeTracker.isActivated()},e.IframeObserverMaxDrillDown=3,e}();i.registerClass("Abra:FrameBinder",N,"IFramesManager, UIChangeTracker, FeaturesManager, Abra:Logger");var W,G=function(){function e(){}return e.isIframe=function(){return top!==window},e.getTopTitle=function(){return top.window.document.title},e}();!function(e){function t(e){var t=!1;return function(){if(!t)return t=!0,e()}}e.allowOnce=t}(W||(W={}));var R,B=function(){function e(e){this.maxDrillDown=e}return e.prototype.observe=function(e,t){var r=this,n=window.MutationObserver;if(n){var i={attributes:!1,childList:!0,subtree:!0};this.observer=new n(function(n){try{r.wasIframeAdded(n)&&e()}catch(i){t(i)}}),this.observer.observe(document,i)}},e.prototype.disconnect=function(){this.observer.disconnect()},e.prototype.wasIframeAdded=function(t){for(var r=0;r<t.length;r++){var n=t[r];if("childList"==n.type)for(var i=n.addedNodes,o=0;o<i.length;o++)if(e.isParentNodeContainsIframe(i[o],this.maxDrillDown))return!0}return!1},e.isParentNodeContainsIframe=function(t,r){if(t&&(t.nodeType===ue.Element||t.nodeType===ue.DocumentType||t.nodeType===ue.Document||t.nodeType===ue.DocumentFragment)){if("IFRAME"===t.nodeName)return!0;var n=t.children;if(r>0&&n)for(var i=0;i<n.length;i++)if(e.isParentNodeContainsIframe(n[i],r-1))return!0}return!1},e}();!function(e){function t(e,t){return{key:e,value:t}}e.createKeyValuePair=t;function r(e){for(var t={},r=0;r<e.length;r++)t[e[r]]=!0;return t}e.convertArrayToObject=r}(R||(R={}));var V=function(){function e(e,t,r,n,i){this.jQuery=e,this.censorshipMethodsProvider=t,this.elementParentsGetter=r,this.featuresManager=n,this.dataCollectionSettings=i,this.allowedInputTypes=["radio","checkbox","button","reset","submit"],this.removeInputValues=!0,this.censorAllText=!1;var o=i.get();this.removeInputValues="collect"!==(o&&o.element&&o.element.inputValues),this.removeInputValues||(this.allowedInputTypes=e.merge(this.allowedInputTypes,["text","search","number","tel","email","url"])),n.isFeatureEnabled("UbtNoText")&&(this.censorAllText=!0)}return e.prototype.isPrivacyUnsafeElementType=function(e){if(e.nodeType===ue.Element&&e.tagName){if(this.removeInputValues&&"true"===this.jQuery(e).attr("contenteditable"))return!0;var t=p.getLowerCaseTagName(e);if(this.removeInputValues&&"textarea"===t)return!0;if("input"===t){var r=(e.type||"").toLowerCase();if(this.jQuery.inArray(r,this.allowedInputTypes)!==-1)return!1;return!0}}return!1},e.prototype.filterCreditCard=function(t,r){if(void 0===r&&(r={}),t){var n=typeof t;if("object"===n)if("number"!=typeof t.length||t.propertyIsEnumerable("length"))for(var i in t)t.hasOwnProperty(i)&&!r[i]&&(t[i]=this.filterCreditCard(t[i]));else for(var o=t.length-1;o>=0;o--)t[o]=this.filterCreditCard(t[o]);else if("string"===n&&t.length>=12){if(e.isCreditCard(t))return null}else if("number"===n&&t>=99999999999)return null}return t},e.isCreditCard=function(e){return e.length>=12&&this.creditCardRegex.test(e)},e.prototype.shouldCensorText=function(e,t){if(this.censorAllText)return!0;return e=e||this.elementParentsGetter.getFromElement(t),this.censorshipMethodsProvider.provide(e).removeTextValues},e.creditCardRegex=/(?:[\s\xA0-]{0,5}\d{4,}){3}/,e}();i.registerClass("Abra:PrivacyUtils",V,"wmjQuery, Abra:CensorshipMethodsProvider, Abra:ElementParentsGetter, FeaturesManager, Abra:DataCollectionSettingsWrapper");var H=function(){function e(){}return e.prototype.gamble=function(e){return Math.random()<=e},e}();i.registerClass("Abra:StatisticsUtils",H);var X=function(){function e(e){this.walkmeCommonUtils=e}return e.prototype.stringify=function(e){return this.walkmeCommonUtils.toJSON(e)},e.prototype.parse=function(e){return this.walkmeCommonUtils.secureEvalJSON(e)},e}();i.registerClass("Abra:JSON",X,"CommonUtils");var _=function(){function e(e,t,r,n,i){var o=this;this.storageManager=e,this.promiseManager=t,this.guidGenerator=r,this.sessionPersister=n,this.jQuery=i,this.libCallback=function(){return o.createNew()}}return e.prototype.load=function(){if(this.jQuery(s.WalkmeInternals).on(e.LibNewSessionEventName,this.libCallback),this.sessionPersister.isNewSession())return this.promiseManager.resolve(this.createNew());return this.getOrCreate()},e.prototype.unload=function(){this.jQuery(s.WalkmeInternals).off(e.LibNewSessionEventName,this.libCallback)},e.prototype.getOrCreate=function(){var e=this;return this.get().then(function(t){return t||e.createNew()})},e.prototype.get=function(){var t=this;return new this.promiseManager.Promise(function(r){t.storageManager.getStorage().getData(e.WindowIdStorageKey,void 0,void 0,function(e){r(e)})})},e.prototype.createNew=function(){var t=this.guidGenerator.generateGuid(!0);return this.storageManager.getStorage().saveData(e.WindowIdStorageKey,t),t},e.WindowIdStorageKey="__WMML_SESSION_ID__",e.LibNewSessionEventName="NewSession",e}();i.registerClass("Abra:WindowIdGetter",_,"Abra:StorageManager, PromiseManager, GuidGenerator, SessionPersister, wmjQuery");var J=function(){function e(e){this.customerLog=e.wrapCustomerLog("Abra")}return e.prototype.error=function(e,t){this.logError(1,e,t)},e.prototype.warn=function(e,t){this.logError(2,e,t)},e.prototype.info=function(e){this.log(3,e)},e.prototype.debug=function(e){this.log(4,e)},e.prototype.logError=function(e,t,r){var n=r&&r.stack||(r&&r.length?r:"");this.customerLog(t+": "+n,e)},e.prototype.log=function(e,t){this.customerLog(t,e)},e}(),z=function(e){n(t,e);function t(t,r,n,i,o){var a=e.call(this,n)||this;a.serverLogger=t,a.ubtPerformance=r,a.walkmeLogger=n,a.walkMeInfo=i,a.featuresManager=o,a.enableServerLogger=!0;try{a.libVersion=i.getLibVersion(),o.isFeatureEnabled("UbtReduceServerLogs")&&Math.random()>.05&&(a.enableServerLogger=!1)}catch(s){}return a}return t.registerLogger=function(e){var r="Abra:Logger";return e.has(r)||e.register(r).asCtor(t).dependencies("EventSenderErrorLogger, Abra:UbtPerformance, Logger, WalkMeInfo, FeaturesManager"),e.get(r)},t.prototype.error=function(t,r,n){void 0===n&&(n={}),n.app=s.App.name,n.version=s.App.version,n.rev=s.App.rev,n.libVersion=this.libVersion,r&&(r.message||r.stack?(n.errorMsg=r.message,n.stack=r.stack):"string"==typeof r&&(n.errorMsg=r)),void 0===n.errorMsg&&void 0!==r&&(n.errorMsg='could not get errorMsg, error type is "'+typeof r+'"'),this.enableServerLogger&&this.serverLogger.logError(t,n),e.prototype.error.call(this,t,r)},t.prototype.perf=function(e){return this.ubtPerformance.perf(e)},t}(J),q=function(){function e(e){this.performanceLogger=e,this.perfOptions=this.createPerfOptions()}return e.prototype.createPerfOptions=function(){return{extraData:{app:s.App.name,version:s.App.version,gitRevision:s.App.rev}}},e.prototype.perf=function(e){var t=this.performanceLogger.measure(s.App.name+"-"+e,this.perfOptions);return{stop:function(){return t&&t.stop()},step:function(e){}}},e}(),K=function(){function e(e,t,r){if(this.logger=e,this.settings={},i.getCtx().has("DataCollectionSettings")){var n=i.getCtx().get("DataCollectionSettings").get();this.settings=t.extend(!0,{},n),r.gamble(.02)&&this.validateSettings(this.settings)}this.settings.element=this.settings.element||{},this.applyCensorshipDefaults(),this.applyXpathDefaults()}return e.prototype.validateSettings=function(e){e.element||e.page||e.loading||this.logger.error("Collection settings are missing, using default")},e.prototype.applyCensorshipDefaults=function(){this.settings.element.censorshipRules=this.settings.element.censorshipRules||[],this.settings.element.censorshipRules.push({type:"classInElementTree",values:["jaco-hide","wm-hide"],methods:["removeTextValues"]})},e.prototype.applyXpathDefaults=function(){this.settings.element.xpath=this.settings.element.xpath||{},this.settings.element.xpath.classMaxLength=this.settings.element.xpath.classMaxLength||35,this.settings.element.xpath.idMaxLength=this.settings.element.xpath.idMaxLength||40,this.settings.element.xpath.attributeMaxLength=this.settings.element.xpath.attributeMaxLength||300,this.settings.element.xpath.xpathMaxLength=this.settings.element.xpath.xpathMaxLength||3e3},e.prototype.get=function(){return this.settings},e}();i.registerClass("Abra:DataCollectionSettingsWrapper",K,"Abra:Logger, wmjQuery, Abra:StatisticsUtils");var $=function(){function e(e,t){this.dataCollectionSettings=e,this.featuresManager=t,this.result=void 0}return e.prototype.shouldCensorUrl=function(){return void 0===this.result&&(this.result=this.checkCollectionSettings()||this.checkLegacyFlags()),this.result},e.prototype.checkCollectionSettings=function(){var e=this.dataCollectionSettings.get();return!!(e&&e.page&&e.page.censorship&&e.page.censorship.url)},e.prototype.checkLegacyFlags=function(){return this.featuresManager.isFeatureEnabled("disableWidgetOpenFullUrl")||this.featuresManager.isFeatureEnabled("dontSendPageUrl")},e}();i.registerClass("Abra:UrlCensorshipController",$,"Abra:DataCollectionSettingsWrapper, FeaturesManager");var Z=function(){function e(e){this.storage=e}return e.prototype.getData=function(e,t,r,n){this.storage.sessionGetData(e,t,r,n)},e.prototype.saveData=function(e,t){this.storage.sessionSetData(e,t)},e}(),Y=function(){function e(){}return e.prototype.getData=function(e,t,r,n){n(sessionStorage[e]||t)},e.prototype.saveData=function(e,t){sessionStorage[e]=t},e}(),ee=function(){function e(e){this.walkme=e,this.isCrossDomain()?this.storage=new Z(this.walkme.getClientStorageManager()):this.storage=new Y}return e.prototype.isCrossDomain=function(){var e=this.walkme.getStorageType();if(e.indexOf("crossdomain")!==-1)return!0;return!1},e.prototype.getStorage=function(){return this.storage},e}();i.registerClass("Abra:StorageManager",ee,"Abra:Walkme");var te=function(){function e(e,t){this.promiseManager=e,this.storageManager=t}return e.prototype.getStorageKey=function(){var t=this;return new this.promiseManager.Promise(function(r){G.isIframe()?t.storageManager.getStorage().getData(e.StorageNumberKey,1,void 0,function(n){t.storageManager.getStorage().saveData(e.StorageNumberKey,Number(n)+1),r("wm-dc-storage"+n)}):r("wm-dc-storage0")})},e.StorageNumberKey="__WMML_STORAGE_NUM__",e}();i.registerClass("Abra:StorageSynchronizer",te,"PromiseManager, Abra:StorageManager");var re=function(){function e(){}return e.Value={element:{autoQuery:500,text:500,value:120},ctx:{topTitle:512}},e}(),ne=function(){function e(){this.buffer=[]}return e.prototype.append=function(e){this.buffer.push(e)},e.prototype.toString=function(){var e=this.buffer.join("");return e},e}(),ie=function(){function e(){}return e.escapeSurrogatePairs=function(t){if(!e.containsSurrogatePair(t))return t;for(var r=-1,n=t.length,i=new ne;++r<n;){var o=t.charAt(r);/[\uD800-\uDBFF]/.test(o)||/[\uDC00-\uDFFF]/.test(o)?i.append(e.escapeChar(o)):i.append(o)}return i.toString()},e.containsSurrogatePair=function(e){var t=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g;return null!=t.exec(e)},e.escapeChar=function(e){var t=e.charCodeAt(0),r=t.toString(16).toUpperCase(),n=r.length>2,i="\\"+(n?"u":"x")+("0000"+r).slice(n?-4:-2);return i},e}(),oe=function(){function e(e){this.privacyUtils=e}return e.substringObject=function(t,r){if(t&&r&&"object"==typeof r)for(var n in t)if(t.hasOwnProperty(n)&&r.hasOwnProperty(n)){var i=typeof r[n];"string"===i&&"number"==typeof t[n]?r[n]=r[n].substring(0,t[n]):"object"===i&&(r[n]=e.substringObject(t[n],r[n]))}return r},e.trim=function(e,t){if(void 0!==t)return e.replace(/^[\s\uFEFF\xA0]+/g,"").substr(0,t).replace(/[\s\uFEFF\xA0]+$/g,"");return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},e.removeExtraSpaces=function(e){var t=/\s+/g;return e.replace(t," ").trim()},e.extractElementText=function(t){var r=t.nodeValue;return r&&(r=e.removeExtraSpaces(r),r=ie.escapeSurrogatePairs(r)),r},e.prototype.collectText=function(e,t){var r={textBuffer:[],totalLength:0,active:!0};this.collectTextInner(e,t,r);var n=r.textBuffer.join("\n");return void 0!==t.maxLength&&n.length>t.maxLength&&(n=n.substring(0,t.maxLength)),n},e.prototype.collectTextInner=function(t,r,n){if(t&&!this.privacyUtils.isPrivacyUnsafeElementType(t)){if(p.isElementTextNode(t)){var i=e.extractElementText(t);if(i&&0!==i.length){void 0!==r.maxNodeTextLength&&(i=i.substring(0,r.maxNodeTextLength));var o=!1;void 0!==r.textFilterCb&&(o=r.textFilterCb(i,t.nodeValue)!==!0),o===!1&&(n.textBuffer.push(i),n.totalLength+=i.length,(void 0!==r.maxLength&&n.totalLength>=r.maxLength||r.collectFirstOnly===!0)&&(n.active=!1))}}var a=!1;if(r.includeNonVisual!==!0&&(a=p.isVisualDomElement(t)===!1),t.childNodes&&n.active&&a===!1)for(var s=0,u=t.childNodes.length;s<u&&n.active;s++)this.collectTextInner(t.childNodes[s],r,n)}},e.escapeRegExp=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},e.escapeJQuerySelectorAttributeValue=function(e){return e.replace(this.escapeJQuerySelectorAttributeValueRegex,'\\"')},e.escapeJQuerySelectorAttributeValueRegex=/"/g,e}();i.registerClass("Abra:TextUtils",oe,"Abra:PrivacyUtils");var ae=function(){function e(e,t){this.timerManager=e,this.errorUtils=t,this.enabled=!0}return e.prototype.clearTimeout=function(e){e&&e.clear()},e.prototype.disable=function(){this.enabled=!1},e.prototype.setTimeout=function(e,t){var r=this;if(this.enabled)return this.timerManager.libSetTimeout(function(){return r.enabled&&r.errorUtils.wrapCallAndLog(e,"timeout")},t)},e.prototype.createOnNextEventLoopFunc=function(e){var t=this;return function(){t.timerManager.libSetTimeout(e,0)}},e.now=function(){return(new Date).getTime()},e.getTimingData=function(){var e=window.performance,t=e&&e.timing;if(t){var r=t.navigationStart,n=t.loadEventEnd;return{navStart:r,loadTime:n-r}}},e}();i.registerClass("Abra:TimingUtils",ae,"TimerManager, Abra:ErrorUtils");var se=function(){function e(e){this.timingUtils=e}return e.prototype.create=function(e,t){return new le(this.timingUtils,e,t)},e}();i.registerClass("Abra:ReusableTimerFactory",se,"Abra:TimingUtils");var ue,le=function(){function e(e,t,r){this.timingUtils=e,this.callback=t,this.delay=r}return e.prototype.clear=function(){this.timerHandle&&(this.timingUtils.clearTimeout(this.timerHandle),this.timerHandle=void 0)},e.prototype.set=function(){this.clear(),this.timerHandle=this.timingUtils.setTimeout(this.callback,this.delay)},e}();!function(e){e[e.Element=1]="Element",e[e.Text=3]="Text",e[e.CDATASection=4]="CDATASection",e[e.DocumentType=9]="DocumentType",e[e.Document=10]="Document",e[e.DocumentFragment=11]="DocumentFragment"}(ue||(ue={}))},function(e,t,r){var n=r(6);function i(e){i.prototype.encode=function(t){var r=n.encode(e.stringify(t));return{_enc:r}}}e.exports={Encoder:i}},function(e,t){var r=31;function n(e){for(var t,n=[],i=e.length-1;i>=0;i--)t=e.charCodeAt(i),n.push(~(t&r)&r|t&~r);return String.fromCharCode.apply(null,n)}e.exports={decode:n,encode:n}},function(e,t,r){e.exports=function(e){var t=new(r(8))(e),n=new(r(9))(t,e);return n}},function(e,t){e.exports=r;function r(e){this.getJQuery=t;function t(t){if(e.jquery)return e.jquery;if(e.getJQuery)return e.getJQuery(t);var r=n(t);return r&&r.wmjQuery}function r(t){if(e.fnName)return e.fnName;if(t){if(t.getLibWrappedWindow)return"getLibWrappedWindow";if(t.getLibWindow)return"getLibWindow"}}function n(t){if(e.winProvider){var n=r(e.winProvider);return e.winProvider[n](t)}return window}}},function(e,t){e.exports=r;function r(e,t){this.isEnabled=function(){try{return t.featuresService&&t.featuresService.isEnabled("jQueryProxy")}catch(e){return!1}},this.jqProxyProp=function(t,r){if(this.isEnabled()){var n=e.getJQuery(t);if(n&&n.fnHelpers)return n.fnHelpers[r](t)}return t[r]},this.parentNode=function(e){return this.jqProxyProp(e,"parentNode")},this.firstElementChild=function(e){return this.jqProxyProp(e,"firstElementChild")},this.childNodes=function(e){return this.jqProxyProp(e,"childNodes")},this.previousSibling=function(e){return this.jqProxyProp(e,"previousSibling")}}},function(e,t,r){!function(t,r){"object"==typeof e&&"object"==typeof e.exports?e.exports=r:t.queryGenerator=r}(this,function(e,t){var n;return function(n){var i=["DIV","SPAN","HTML","BODY","TR","TD"],o=["'"],a=r(11);a.setJQuery(e);function s(t){var r=c(t),n=[t[0]].concat(r),i=e.map(n,f),o=h(i,function(e){return null!==e}),a=d(o);a=a.reverse();var s=e.map(a,p),u=s.join(" ");return l(u)?u:void 0}n.generate=s;function u(e,t,r){if(!e)return e;var n=/^((.+) )*(([^\[]+)(\[id=".*"\])?)$/,i=e.match(n),o=i[1]||"",s=i[4],u=o+s;return!t&&r&&a.isPhraseHuman(r)&&(u+='[id="'+r+'"]'),u}n.modifyAutoQuery=u;function l(e){if(!e||!e.length)return!1;for(var t=0;t<o.length;t++)if(e.indexOf(o[t])>=0)return!1;return!0}function c(e,r){for(var n=t.parentNode(e[0]),i=r&&r[0]&&t.parentNode(r[0]),o=[];n&&1==n.nodeType&&n!=i;n=t.parentNode(n))o.push(n);return o}function h(e,t){for(var r=[],n=0;n<e.length;++n){var i=e[n];t(i)&&r.push(i)}return r}function p(e){var t=e.tagName;return e.id&&(t+='[id="'+e.id+'"]'),t}function d(e){for(var t=e.length,r=0;r<e.length;r++){var n=e[r];if(n.id){t=r;break}}var i=e.slice(0,t+1);return i}function g(e){var t=e.attr("id");if(t&&a.isPhraseHuman(t))return t;return null}function f(t,r){var n=e(t),o=g(n),a=n[0].tagName,s=e.inArray(a,i)>=0,u=0===r,l=u||o||!s;if(!l)return null;var c={tagName:a,id:o};return c}}(n||(n={})),n})},function(e,t){var r;!function(e){var t,r,n=/[a-zA-Z]/,i=/[0-9]/;!function(e){e[e.Digit=0]="Digit",e[e.Alphabet=1]="Alphabet",e[e.Other=2]="Other"}(r||(r={}));function o(e){t=e}e.setJQuery=o;function a(e){var t=new h,r=new u(e),n=t.isHuman(r);return n}e.isPhraseHuman=a;function s(e){if(n.test(e))return r.Alphabet;if(i.test(e))return r.Digit;return r.Other}var u=function(){function e(e){this.words=[],this.raw=e,this.buildWords()}return e.prototype.buildWords=function(){this.splitCategories()},e.prototype.addWord=function(e){var n=this;if(e=t.trim(e),!e)return;if(s(e[0])!==r.Alphabet)this.words.push(e);else{var i=this.splitCamelCase(e);t.each(i,function(e,t){return n.words.push(t.toLowerCase())})}},e.prototype.splitCamelCase=function(e){var t=e.replace(/([a-z](?=[A-Z]))/g,"$1 "),r=t.split(" ");return r},e.prototype.splitCategories=function(){for(var e,t=s(this.raw[0]),r=0,n=0;n<this.raw.length;n++){var i=this.raw[n],o=s(i);o!=t&&(e=this.raw.substring(n,r),this.addWord(e),r=n,t=o)}e=this.raw.substring(r,n+1),this.addWord(e)},e}();e.Sentence=u;var l=5,c=function(){function e(){var e=this;this.WHITE_LIST=["html","css","btn","js","http","a"],this.VOWELS="aeiou",this.pointers={},this.pointers[r.Alphabet]=function(t){return e.alphabetPred(t)},this.pointers[r.Digit]=function(t){return e.numberPred(t)},this.pointers[r.Other]=function(t){return e.otherPred(t)}}return e.prototype.numberPred=function(e){return!1},e.prototype.otherPred=function(e){return!0},e.prototype.alphabetPred=function(e){for(var t=0,r=0;r<e.length;r++){var n=e[r];if(this.VOWELS.indexOf(n)==-1?t++:t=0,t>=l)return!1}return!0},e.prototype.isHuman=function(e){if(this.contains(this.WHITE_LIST,e))return!0;var t=s(e[0]),r=this.pointers[t],n=r(e);return n},e.prototype.contains=function(e,r){return t.inArray(r,e)!==-1},e}();e.WordClassifier=c;var h=function(){function e(){}return e.prototype.isHuman=function(e){if(e.raw.length<=2)return!1;if(this.isUrl(e))return!1;var r=new c,n=t.map(e.words,function(e,t){return r.isHuman(e)}),i=this.all(n);return i},e.prototype.all=function(e){for(var t=e.length-1;t>=0;t--)if(!e[t])return!1;return!0},e.prototype.isUrl=function(e){var t=0==e.raw.indexOf("/")||0==e.raw.indexOf("http");return t},e}();e.SentanceClassifier=h}(r||(r={})),e.exports=r},function(e,t){t.__esModule=!0;var r;!function(e){var t=/([&=\.\]\[\/\#])/g,r=/\\([&=\.\]\[\/\#\\\/])/g;function n(e){return e.replace(t,"\\$1")}e.escape=n;function i(e){return e.replace(r,"$1")}e.unescape=i}(r=t.XpathEscaper||(t.XpathEscaper={}))}])});